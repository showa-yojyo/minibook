======================================================================
Writer Guide Chapter 16, Master Documents ノート
======================================================================

.. include:: ./abbrev.txt

.. contents:: 章見出し
   :depth: 3
   :local:

What is a master document?
======================================================================

マスター文書（.odm）は、別々のテキスト文書（.odt）を一つの大きな文書に結合し、書式、目次（TOC）、書誌、索引、その他の資料を統一するコンテナだ。マスター文書は通常、書籍や論文、長いレポートなど、長い文書を作成する際に使用される。図1は、マスター・文書の典型的なスキームを示している。

.. note::

   マスター文書は、実際には、リンクされたサブ文書を処理するためのいくつかの特別な機能を備えたWriter文書だ。マスター文書では、印刷、PDFへのエクスポート、従来のWriterテキスト文書へのエクスポートなど、テキスト文書のすべての機能が利用できる。

Why use a master document?
======================================================================

このような状況では、マスター文書が特に有用である：

* ファイルサイズやページ数が非常に大きい場合。文書全体の部分集合で書くと、執筆、レビュー、編集が容易になる場合がある。
* セキュリティーや信頼性の理由から、章を別々の場所に保存し、文書全体を紛失するリスク（単一障害点）を最小限に抑える場合。
* 長い報告書で、報告書の構造に影響を与えない範囲で、サブ文書の単一セットを定期的に更新する必要がある場合。
* 異なる人が異なる章や文書の他の部分を執筆する場合。
* ファイルが独立した文書として発行されるだけでなく、より大きな文書の一部となる場合。このライターガイドの各章は、この使い方の一例だ。
* サブ文書が複数の最終文書で使用される場合。

マスター・文書の作成にはいくつかの方法がある。それぞれの方法には長所と短所がある。どの方法を選ぶかは、あなたが何を達成しようとしているかによります。この章では、さまざまな方法について、それぞれをどのようなときに使うべきかという提案とともに説明する。

Master document Navigator
======================================================================

Writerでは、ナビゲータには二つの形式がある。一つは通常のテキスト文書で使用され、もう一つはマスター文書で使用される。

通常のテキスト文書では、図2の左側に示すように、ナビゲータは文書内の図形、表、索引項目、ハイパーリンク、参照、その他の項目の一覧を表示する。右側のマスター文書ナビゲータは、図1の文書構造を表示する。

マスター文書では、左上の Toggle Master View 図像をクリックすることで、通常ビューとマスタービューを切り替えることができる。マスタービューでは、図2の右側に示すように、ナビゲータがサブ文書とテキストセクションを一覧表示する。マスター文書でのナビゲータの使い方については、この章の後半で詳しく説明する（「ステップ6.サブ文書をマスター文書に挿入する」（11 ページ）および「複数の文書をマスター文書に結合する」（13 ページ）を参照）。

.. note::

   マスター文書に表示されているサブ文書の内容を編集することはできない。サブ文書は読み取り専用モードでリンクされている。編集しようとすると警告が表示される。

   しかし、マスター・文書・ナビゲータでサブ文書のエントリをダブルクリックすると、編集用にサブ文書が開く。これは、マスター文書の仕上げをするときに、サブ文書ファイルをすばやく開く便利な方法だ。

Styles in master documents and subdocuments
======================================================================

単体の文書は、マスター文書にリンクされるとサブ文書になる。

文書は、複数のマスター文書でサブ文書として使用することができる。各マスター文書は、最終文書の外観に影響を与える異なるスタイル定義（フォント、活字サイズ、色、ページサイズ、余白など）を持つことができるが、個々の文書は元の特性を保持する。

マスター文書とそのサブ文書のスタイル間の関係は以下の通りです：

* 段落スタイルなど、サブ文書で使用されているカスタムスタイルは、自動的にマスター文書で使用できるようになる。これにより、マスター文書のサブ文書のカスタム書式が保持される。
* サブ文書のスタイルはマスター文書でのみ変更されるので、サブ文書が編集のために開かれたとき、元のサブ文書のスタイルは影響を受けません。これにより、サブ文書のスタイル仕様が保持される。
* マスター文書とサブ文書に同じ名前のスタイルが存在する場合 (例えば既定の段落スタイル)、マスター文書のスタイルがサブ文書のスタイルを上書きする。これにより、マスター文書の最終結果において、すべてのサブ文書の内容に書式の一貫性が与えられる。
* 複数のサブ文書が同じ名前のカスタムスタイル (例えば myBodyText) を使用している場合、リンクされる最初のサブ文書のものだけがマスター文書にインポートされる。最初のサブ文書のカスタムスタイルは、他のサブ文書で使用されている同名のカスタムスタイルを上書きする。
* サブ文書で使用されている直接書式はマスター文書で保持される。

.. tip::

   マスター文書のベストプラクティスでは、マスター文書とそのサブ文書に同じ文書雛形を使用することを推奨している。そうすれば、サブ文書をマスター文書に読み込んだときにも、個々のファイルとして見たときと同じように見えます。

   スタイルを変更または作成するときは、必ず雛形で変更を行ってください。そうすれば、サブ文書やマスター文書を再度開いたときに、雛形からスタイルを更新することができる。

   マスター・文書とサブ・文書が同じオリジナル・雛形を共有していない場合、すべてのサブ・文書とマスター・文書で利用可能なスタイルのセットを更新する必要があるかもしれない。

Updating a master document
======================================================================

マスター・文書は個々のサブ・文書をリンクするためのコンテナであるため、特にサブ・文書を編集した後は、定期的にマスターを更新し、索引、目次、ページ番号、参考文献などを更新することが重要だ。

.. note::

   マスター文書を開くと、Writerがサブ文書へのリンクを更新するよう促する。はい]をクリックすると、マスター文書がすぐに更新される。

マスター文書をいつでも更新するには、「ツール」→「更新」→「すべて更新」（またはサブメニューに一覧された特定の要素のいずれか）を選択するか、マスター文書ナビゲータの図像を使用する（図3）。

文書の複雑さによっては、この操作に時間がかかることがある。Writerがすべてのリンクファイルを調べて、すべての参照を調整したマスター文書を再構築するからだ。

.. note::

   マスター文書を保存すると、すべてのサブ文書がマスターに埋め込まれる。これにより、リンクされたサブ文書が利用できない場合でも、マスター文書を完全に開くことができる。この場合、すべてのリンクを更新するかどうか尋ねられたら、[いいえ]を選択しろ。

Creating a master document: scenarios
======================================================================

マスター・文書を作成する最も一般的な三つの方法からどの方法を選ぶかは、文書の現在の状態によって異なる：

* すでにマスター文書の雛形がある。18ページの「マスター文書雛形の作成」を参照しろ、
* 既存の文書はないが、複数の章を含む長い本を、おそらく複数の著者によって執筆するつもりである。
* 1人または複数の著者による複数の既存の文書（章）があり、マスター文書によって管理される1冊の本にまとめたい。
* つの既存の文書（本）を、マスター文書によって管理される複数のサブ文書（章）に分割したい。

これらのシナリオを順番に見ていきましょう。

Starting with a master document template
======================================================================

第10章「雛形の操作」で説明したように、以前に作成したマスター文書雛形を使って、白紙のマスター文書を開始することができる。この雛形には、書式スタイル、文書の表紙と裏表紙、目次、その他最終的な文書の一部を含めるのが理想的だ。

#. テキストや改ページが雛形からこの文書に入っている場合は、そのテキストを削除する。(TOC、索引、ヘッダーとフッターのフィールドは残せます)。
#. 「ステップ6.1一ページの「ステップ6.マスター文書にサブ文書を挿入する」の説明に従って、サブ文書を追加する。
#. 参照、目次、ページ番号、その他の自動操作が更新されるように、マスター文書を更新する。

Starting with no existing documents
======================================================================

既存の文書がない状態から始める場合、最初からすべてを思い通りに設定することができる。以下の順番に従ってください。各ステップは、以下のトピックで詳しく説明されている。

.. todo:: ここに見出し一覧をはめ込めないか？

Step 1. Plan the project
----------------------------------------------------------------------

このプロセスのほとんどの段階で変更は可能だが、始める前に計画を立てておけば、後で問題を修正する手間が省ける。以下は、計画する必要があるいくつかの事柄である。図1は、タスクを計画するための構造を示している。

本や報告書に必要な部分マスター文書にはどのページを、サブ文書には何を入れるか。下表に示す部分を持つ本を例にとって考えてみましょう。

.. Part
.. Location
.. Title (cover) page
.. In master document
.. Copyright page
.. In master document
.. Table of contents (TOC)
.. In master document
.. Preface (Foreword)
.. Subdocument
.. Chapters 1 to 7
.. Subdocuments
.. ‍Bibliography
.. In master document
.. Index
.. In master document

ページ、段落、文字、枠、番号のスタイル。使用するスタイルを決めます。スタイルを作成または変更する方法や、ブックデザインにおけるスタイルの使用例については、第8章「スタイル入門」および第9章「スタイルの使用」を参照しろ。第8章で説明されているように、スタイルを使った見出しの設定には特に注意しろ。

必要に応じて、フィールドとオートテキストエントリ。第2章テキストを扱う：アイデアについては、第2章テキストの操作：基本、および第17章フィールドを参照しろ。

マスター・文書とサブ・文書用の一つ以上の雛形。新しいプロジェクトを始める場合は、マスター文書とすべてのサブ文書を同じ雛形から作成しろ。同じ雛形を使用しないと、スタイルの不一致が生じ、文書が期待どおりに表示されないことがある。例えば、二つのサブ文書に同じ名前のスタイルがあり、それぞれの文書で書式が異なる場合、マスター文書は最初に追加されたサブ文書の書式を使用する。

ページ番号。この例では、表題ページから順にページ番号を振っている。(表題ページのスタイルはページ番号を表示しないように定義できるが、それでも一ページ目としてカウントされる)。したがって、最初の章は、例えば5ページのような、より大きな番号のページから始まります。最初の章のページ番号が1から始まるブックを作成するには、いくつかの追加作業が必要だ。15ページの「ページ番号の付け直し」を参照。

Step 2. Create a template
----------------------------------------------------------------------

この文書に必要なページ、段落、文字、その他のスタイルの一部またはすべてを含む既存の文書や雛形から雛形を作成することも、白紙の文書から雛形を作成することもできる。雛形の詳細については、第10章「雛形の操作」を参照しろ。雛形を作成する際は、必ず「ファイル」→「雛形として保存」を使用しろ。

.. tip::

   マスター・文書・雛形を作成することもできる。

Step 3. Create the master document
----------------------------------------------------------------------

マスターとサブ文書をどのような順番で作成してもかまいないし、プロジェクトを開始するときにすべてのサブ文書を同時に作成する必要もない。新しいサブ文書は、必要なときにいつでも追加することができる。

以下の手順でマスター・文書を作成しろ：

#. ステップ2で作成した雛形から新しい文書を開く。ファイル＞新規＞雛形の順に選択し、作成した雛形を選択して雛形を作成する。この新しい文書の最初のページが、最終文書の最初のページに設定したいページスタイルに設定されていることを確認する。この例では、最初のページのスタイルは表題ページだ。
#. テキストや改ページが雛形からこの文書に入っている場合は、そのテキストを削除する。(TOC、索引、ヘッダーとフッターのフィールドは残せます）。
#. [ファイル] > [送信] > [マスター文書を作成]をクリックする。マスター文書をこのプロジェクトのフォルダに保存する。このマスター文書については後ほど説明する。今のところ、開いたままにしておくか、閉じておくことができる。

.. note::

   ファイル＞新規＞マスター文書を使用すると、既定の雛形に関連付けられたマスター文書ファイル（.odm）が作成される。文書がカスタム雛形に基づく場合、またはそうなる場合は、上記の方法を使用しろ。

Step 4. Create subdocuments
----------------------------------------------------------------------

サブ文書は他のテキスト文書と変わりません。マスター文書にリンクされ、マスター文書の中から開かれたときのみ、サブ文書となる。サブ文書は独立した文書として使用することもできる。マスター文書のいくつかの設定はサブ文書の設定を上書きするが、それはマスター文書を通して文書を表示、操作、印刷する場合に限られる。

通常の文書を作成するのと同じ方法でサブ文書を作成する：

#. ファイル > 新規 > 雛形を選択し、必要な雛形を選択して、プロジェ クト雛形に基づいた白紙の文書を開く（非常に重要）。
#. 雛形から持ってきた不要なテキストやその他の素材を削除し、最初のページを章の最初のページに指定したページスタイルに設定する。
#. ファイル＞名前を付けて保存をクリックする。文書に適当な名前を付けて、このプロジェクト用のフォルダに保存する。

すでにいくつかの章が書かれている場合、そのファイルはこのプロジェクトのために作成した雛形に基づいていないかもしれない。既存のファイルをそのままサブ文書として使用することはできるが、それらのファイルに添付されている雛形を変更したいかもしれない。その場合は、第10章雛形の操作で説明されているテクニックを使用しろ。

Step 5. Add some pages to the master document
----------------------------------------------------------------------

以下のようにしろ：

* 段落マークが表示されていることを確認する。ツール] > [オプション] > [LibreOffice Writer] > [書式設定補助] で設定するか、[標準] ツールバーの [書式マークを切り替える] 図像をクリックするか、Ctrl+F10 キーを押する。
* テキストの境界、表の境界、セクションの境界を表示する (ツール > オプション > LibreOffice > アプリケーションの色)。

マスター文書に、表題ページ、コピーライトページ、TOCページなど、必要な「フロントマター」が含まれていない場合は、今すぐ追加しろ。このセクションの例では、「ステップ1.8ページの「プロジェクトを計画する」で示したページスタイルの順序を使用する。

#. 作成したマスター文書（.odmファイル）を開き、表題ページの内容を入力する（またはプレースホルダーを残して後で記入する）。ページの最後の空白段落に挿入ポイントを置き、「挿入」→「その他の改行」→「手動改行」をクリックする。改行の挿入］ダイアログボックスで、［改ページ］と二ページ目のページスタイル（この例では［著作権ページ］）を選択し、［ページ番号の変更］オプションは選択しないままにする。OKをクリックする。
#. コピーライトページの内容を入力する（またはプレースホルダーを残す）。ページの最後の空白の段落に挿入ポイントを置き、同じ方法でもう一つ手動改ページを挿入し、今度はページスタイルを目次ページに設定する。
#. 目次ページで、空白の段落を一つか二つ残すか、TOCを挿入する（挿入 > 目次と索引 > 目次、索引、または書誌）。TOCは、サブ文書を追加するまで内容を持ちませんが、灰色のマークまたはボックスがその位置を示する。TOCの挿入とフォーマットについては、第15章目次、索引、書誌を参照しろ。

.. note::

   CopyrightとTOCページの最初の段落（通常は見出し）のスタイル定義によっては、手動で改ページを挿入する必要がない場合もある。

Step 6. Insert the subdocuments into the master document
----------------------------------------------------------------------

これでサブ・文書を追加する準備ができた。

.. tip::

   サブ文書は、ナビゲーターでハイライトされた項目の前にマスター文書に挿入される。最後のサブ文書を最初に挿入し、他のサブ文書を最後のサブ文書の前に挿入すると、一覧の上下に移動することなく、正しい順序で挿入される。

#. ナビゲータを表示する（Sidebarのナビゲータ図像をクリック）。
#. ナビゲータにマスタービューが表示されていることを確認する（5 ページの「マスター 文書 ナビゲータ」を参照）。必要に応じて、左上の［マスタービューの切り替え］図像をクリックして、通常ビューとマスタービューを切り替えます。
#. ナビゲータ上でテキストを選択し、ナビゲータツールバーの［挿入］→［ファイル］をクリックするか、テキスト上で右クリックし、コンテキストメニューの［挿入］→［ファイル］を選択する。

   標準的なファイルブラウザのダイアログボックスが開く。ステップ4で作成した）必要なファイルを選択し、Insertをクリックする。この例では7つの章を使用する。上のヒントで提案したように、第7章を最初に読み込みます。

   挿入されたファイルは、図6に示すように、ナビゲータでテキスト・アイテムの前に一覧される。
#. テキストセクションには表題ページやその他の資料が含まれているので、それをハイライトし、上へ移動図像をクリックして一覧の一番上に移動する。(または、挿入したサブ文書(第7章)をハイライトし、下に移動図像をクリックして、テキストセクションの下に移動する)。
#. 挿入したサブ文書 (第 7 章) をハイライトし、[挿入] > [ファイル] をクリックして最初のサブ文書を挿入する。この例では第1章だ。第 2 章、第 3 章と、すべてのサブ文書が一覧に追加されるまで繰り返す。複数のファイルを同時に挿入することもできる。ナビゲータは図7のようになる。
#. マスター文書を再度保存する。

.. tip::

   ナビゲータでサブ文書のエントリをドラッグ＆ドロップすることで、マスター文書内のサブ文書の順序を変更することができる。

Step 7. Add table of contents, bibliography, index
----------------------------------------------------------------------

マスター文書を使って、本の目次、書誌、索引を作成することができる。これらの項目をマスター文書のテキストセクションに挿入する必要がある。これらの文書要素については、第15章目次、索引、書誌を参照しろ。

ステップ5で目次を挿入しなかった場合は、目次を挿入する最初のテキストセクションのページにキャレットを置き、「挿入」＞「目次と索引」＞「目次、索引、または書誌」を選択して目次を作成する。

マスター文書の最後にテキストセクションがない場合は、最後のサブ文書の前にテキストセクションを挿入し、最後のサブ文書の後になるように下に移動する。これで、サブ文書に書誌項目が含まれている場合、この最後のテキストセクションの書誌が入るページに挿入ポイントを置き、書誌を作成することができる。

サブ文書に索引項目を含めている場合は、索引が入る最後のテキストセクションのページに挿入ポイントを置き、索引を作成する。

Figure 8 shows the Navigator after addition of a TOC and index.

Combining several documents into a master document
======================================================================

既存の文書が複数ある場合、マスター文書によって管理される一つの文書にまとめることができる。

この方法は、すべての文書が同じ雛形から作成された場合に最も効果的だが、文書が異なる雛形から作成された場合にも使用できる。この方法は、サブ文書が複数のライターによって作成または管理されている場合に特に便利だ。例えば、短編小説のアンソロジー、シンポジウムの論文集、標準的な会社の表題ページを持つエンジニアリングのテスト結果一式などを作成する場合だ。

ここでは、工学的な試験結果をまとめた本を例に挙げて説明する。

.. tip::

   マスター・文書・雛形を作成し（18ページ参照）、それをこの方法の出発点として使用することもできる。その場合は、ステップ1と2を飛ばしてステップ3から始めてください。

#. マスター文書として使用する予定の表題ページ文書を開く。この文書をマスター文書に変換する際、サブ文書が増えすぎないように、レベル1の見出しは一つだけにしろ。それ以上ある場合は、一時的に低レベルの見出しに変更し、それがどれであるかをメモしておく（例えば、各見出しの末尾にアスタリスクを付け、後でレベル1の見出しに戻す必要があることを忘れないようにする）。
#. ファイル」→「送信」→「マスター文書の作成」を選択し、このマスター文書に名前を付けて保存する（14ページの「やり方」を参照）。

   元の文書はFrontPageという名前で、レベル1の見出しが一つあり、マスター文書（.odmファイル）を作成するときにTestFileという名前を付けたとする。

   この場合、マスター・文書は一つのセクションだけを含む空白のファイルだ。TestFile1という名前のサブ文書も同時に作成され、これはFrontPageファイルのテキストを含む.odtファイルだ。.odmファイルを開き、「はい」をクリックしてすべてのリンクを更新すると、このファイルがマスター文書にリンクされ、オリジナルの中身が提供される。

   元のFrontPageファイルはフォルダにそのまま残される。
#. マスター文書を開き、「はい」をクリックしてリンクを更新する。マスター文書は既定でナビゲータが表示された状態で開く(5ページの「マスター文書のナビゲータ」と1一ページの「ステップ6.詳しくは1一ページの「マスター文書にサブ文書を挿入する」をご覧ください）。
#. Insert 図像をクリックし、File を選択する。
#. 検査結果ファイル（Results1.odt、Results2.odt など）の場所に移動する。挿入する最初のファイル（例えば Results1.odt）を選択し、Insertをクリックする。ファイルが既存の項目の上に挿入される。
#. [上へ移動] 図像をクリックして、TestFile1 テキストを Results1 テキストの上に配置する (ファイルの内容は、マスター 文書で選択されたファイルの上に挿入される)。
#. ステップ 4 を必要なだけ繰り返する。次のファイルを挿入するときに、マスター文書でどのファイルがハイライトされているかは問題ではない。挿入されたファイルを選択し、上へ移動または下へ移動図像を使用して、必要に応じて配置するだけだ。
#. マスター文書を編集し、シリアル番号と顧客名を追加するには、マスター文書で TestFile1.odt を右クリックし、コンテキストメニューから Edit を選択する。開いたファイルに必要な内容を追加し、ファイルを保存して閉じる（詳細については17ページの「マスター文書の編集」をご覧ください）。
#. メニューで[ツール] > [更新] > [リンク]を選択するか、ナビゲータで[更新] > [リンク]をクリックし、[はい]をクリックして確定する。マスター文書の編集内容がすべて表示される。

Splitting a document into master and subdocuments
======================================================================

マスター文書と複数のサブ文書に分割したい既存の文書がある場合、Writerで文書を見出しで自動的に分割し、アウトラインレベルを選択することができる。

この方法は素早く簡単だが、いくつかのクリーンアップ作業が必要になる場合がある。

自動的に生成されるサブ文書のファイル名はmaindocnameX.odtで、Xは1、2、3...となる。第1章の前に見出し1で始まる序章やその他の「章」がある場合、ファイル名は章番号に直接対応しない。17 ページの「サブ文書の追加、削除、名前の変更」を参照しろ。

方法

#. Open the document and choose File > Send > Create Master Document.
#. On the Name and Path of Master Document dialog (Figure 11):

   #. マスター文書とそのサブ文書を保存するフォルダに移動する (または新しいフォルダを作成する)。
   #. ファイル名ボックスにマスター文書の名前を入力する。
   #. separated by: 一覧で、ファイルをサブ文書に分割するアウトラインレベルを選択する。通常、これはアウトラインです：レベル1だが、あなたの文書は異なる構造になっているかもしれない。アウトラインレベルの詳細については、第8章 スタイル入門を参照しろ。
   #. 自動ファイル名拡張子]オプションを選択したまま[保存]をクリックすると、文書がサブ文書に分割され、マスター文書が作成される。

アウトラインを選択した場合レベル 1 を選択し、そのレベルの段落スタイルが見出し 1 の場合、各サブ文書は見出し 1 の段落で始まります。

Restarting page numbering
======================================================================

前のセクションの例では、連続したページ番号を持つファイルの非常に基本的なコレクションを示した。これは、電子書籍を含む多くの文書に便利だが、典型的な印刷された書籍は、ページ番号の順序は次のとおりです：

* 表紙や著作権ページにはページ番号を付けない。
* 本文ではiから始まる小文字のローマ数字。
* 本文では1から始まるアラビア数字。
* ページ番号は本の残りの部分を通して連続。

このような本を作るためにマスター文書を設定するには、最初の章の見出しに別の段落スタイルを定義し、それに二つの特別な特性を割り当てる必要がある。

.. rubric:: Example

各章は、段落スタイルダイアログボックスのテキストフロータブの区切りセクションで設定した、新しいページから始まる見出し1の段落で始めることができる（図12）。ページ番号チェックボックスは選択されていないので、番号は前のページの番号から続く。

このダイアログボックスの「アウトラインと一覧」タブ（図13）を見て、見出し1がどのアウトラインレベルに割り当てられているかを確認する。通常はアウトラインレベルです：レベル1だ。このレベルは「ツール > 見出し番号」で設定されているので、ここで変更することはできない。

ツール] > [見出し番号付け] でアウトラインレベル 1 に割り当てられる段落スタイルは 1 つだけだ。しかし、［段落スタイル］ダイアログボックスの［アウトラインと一覧］タブを使えば、どのアウトラインレベルにも追加の段落スタイルを割り当てることができる。

そこで、「見出し1」と外観は同じだが、本質的な違いが一つある「見出し1章1」というスタイルを定義したいとする：

#. Sidebarの［スタイル］タブの［段落スタイル］セクションで［見出し 1］を右クリックし、［新規作成］を選択する。段落スタイル］ダイアログボックスの［オーガナイザ］タブで、新しいスタイルに名前を付け、次のスタイルを選択し、［継承元］に［見出し1］が表示されていることを確認する。
#. ［テキストフロー］タブの［区切り］セクションで（図12）、［挿入］、［タイプ］、［位置］、［ページ］を選択する：挿入」、「タイプ：ページ」、「位置挿入］、［タイプ：ページ］、［位置：前］、［ページスタイル］、［ページ番号：1］を選択する：挿入」、「タイプ：ページ」、「位置：前」、「ページスタイル：先頭ページ」、「ページ番号：1」を選択する。
#. Outline & Listタブで、Outline levelをLevel 1に設定する（図15）。これにより、この見出しは他の章見出しと一緒に目次に表示される。見出し番号設定ダイアログボックスでアウトラインレベルが割り当てられていないので、この見出しの一覧スタイルは「一覧なし」だ。
#. さて、新しいスタイルを第1章の最初の段落に割り当てて完了だ。

Editing a master document
======================================================================

マスター文書を作成した後、その外観や内容を変更したい場合がある。

Changing the appearance of the master document
----------------------------------------------------------------------

プロジェクトが発展するにつれて、雛形のスタイルを変更することができる。マスター・文書やサブ文書のスタイルを変更するな。

雛形の変更でマスター・文書（およびすべてのサブ・文書）を更新するには、マスター・文書を開いてください。二つのメッセージが表示される：一つ目は、すべてのリンクを更新するかどうかを尋ねるメッセージ、二つ目は、変更したスタイルを適用するかどうかを尋ねるメッセージだ。これらのメッセージの両方に「はい」と答えてください。

Editing subdocuments
----------------------------------------------------------------------

マスター文書の中からサブ文書を編集することはできない。代わりに、マスター文書のナビゲーターでサブ文書をダブルクリックするか、マスター文書の外からサブ文書を開く必要がある。そうすれば、他の文書と同じように編集することができる。

サブ文書の編集中に、マスター文書に適用されるスタイルに変更を加えたい場合は、上記の「マスター文書の外観を変更する」を参照しろ。

サブ文書の内容を変更する場合は、マスター文書の中から目次、書誌情報、索引を手動で更新する必要がある。

Adding, deleting, or renaming subdocuments
----------------------------------------------------------------------

サブ文書を追加するには、11 ページの「ステップ 6.サブ文書をマスター文書に挿入する」（11 ページ） に記載されている方法に従ってください。

サブ文書を削除するには、ナビゲータでファイル名を右クリックし、削除を選択する。

ファイル名を変更してサブ文書の名前を変更した場合、次にマスター文書のリンクを更新すると、そのサブ文書は壊れたリンク（赤で表示）としてナビゲータに表示される。これを修正するには、ファイル名を元に戻すか（リンクは次回の更新で復元される）、以下の手順に従ってください：

#. ナビゲータで壊れたリンクを右クリックし、リンクの編集を選択する。
#. セクションの編集ダイアログボックス（図16）で、名前を変更したファイルを選択し、セクション名（ナビゲータに表示されている名前）を編集する。
#. OKをクリックして変更を保存する。

Creating a master document template
======================================================================

マスター文書の雛形は、第 10 章「雛形の操作」で説明する他の雛形とほぼ同じ方法で作成する：

#. まず、この章の前のセクションで説明したように、ファイル > 送信 > マスター文書の作成 を使ってマスター文書を作成する。
#. 次に、［ファイル］→［雛形］→［雛形として保存］ を使って雛形 (.otm) を作成し、他の雛形と一緒に［雛形］ ダイアログボックスに表示される。

.. tip::

   マスター・文書・雛形に付ける名前には、それが普通の雛形ではないことを示す何らかの表示を含めてください。

Creating one file from a master document and its subdocuments
======================================================================

マスター文書は、リンクされたサブ文書を含む.odmファイルで、.odtフォーマットだ。リンクされたファイルは、本のような大きな文書を書いたり編集したりするときにとても便利だが、出版社に送るときなど、本全体のコピーを一つのファイルにまとめる必要がある場合もある。

マスター文書を .odt ファイルにエクスポートするには (元の .odm ファイルには影響を与えません)：

#. マスター文書を開き、すべてのリンクを更新する。メニューのファイル > エクスポートを選択する。
#. ［書き出し］ダイアログボックス (図 17) で、書き出す .odt ファイルの名前を入力し、［ファイル形式］ 一覧で ODF テキスト文書 (.odt) を選択する (既定の選択になっているはずです)。エクスポートをクリックする。このステップでは、各サブ文書が個別の書き込み禁止セクションにある .odt ファイルが作成される。
#. マスター文書を閉じ、新しい.odtファイルを開き、すべてのリンクを更新する。
#. リンクを解除し、書き込み保護を解除するには、「書式」>「セクション」と進み、セクション一覧の最初の項目を選択し、一覧の最後の項目をShift+クリックしてすべての項目を選択する。LinkセクションのLinkとWrite ProtectionセクションのProtectの両方の選択を解除する。
#. OKをクリックする。

セクションの一部または全部を削除してプレーンテキスト文書にしたい場合は、削除したいセクションを選択し、［削除］をクリックする。セクションマーカーだけが削除される。OKをクリックする。

Anchoring images
======================================================================

サブ文書のページにアンカーされている画像（画像）がマスター文書に表示されない。マスター・文書は、サブ文書を照合する際に、ページの流れ、ページ番号、相互参照を再編成するため、画像はアンカー参照を失い、消えてしまいる。

対照的に、マスター文書のテキストセクションのページにアンカーされた画像は、そのページに留まり、サブ文書の長さが変わっても移動しない。画像はサブ文書の途中のページになってしまうかもしれない。

.. note::

   アンカー "to page "は非推奨。使用を避けてください。

画像を特定のページに正確に配置するには、次のように画像を固定する：

#. 画像を右クリックし、コンテキストメニューから「プロパティ」を選ぶ。
#. 画像ダイアログボックス（図18）の「種類」タブで、アンカーを「文字へ」、「文字として」、「段落へ」のいずれかに設定する。
#. 「位置」で、ページに対する適切な水平方向と垂直方向の参照を選択する。OK をクリックして変更を保存する。
