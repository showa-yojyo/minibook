======================================================================
Calc Guide Chapter 5 Using Styles and Templates ノート
======================================================================

.. contents::
   :local:

What are styles? Why use them?
======================================================================

   A style is a set of formats that you can apply to selected elements in a
   document to quickly change their appearance.

スタイルを使用するということは、属性や特性を個別に適用するのをやめることになる。
属性や特性を手動で適用するのは時間がかかり、エラーになりがちだ。対照的に、必要な
属性や特性を含むように定義されたスタイルを使用することで、時間を節約し、書式設定
に一貫性を持たせられる。

* スタイルによって書式の大幅な変更も簡単に行える。
* 図面とページに対するスタイルもある。

Direct formatting and style formatting
----------------------------------------------------------------------

手動書式設定はスタイルを上書きする。スタイルを適用して手動書式を削除することは不
可能だ。この書式を削除するには、対象オブジェクトを選択し次のいずれかを実行する：

* 右クリックメニュー :menuselection:`Clear &Direct Formatting` を実行
* :kbd:`Ctrl` + :kbd:`M`
* :guilabel:`Standard` ツールバー :guilabel:`Clear Direct Formatting` を押す
* メインメニュー :menuselection:`F&ormat --> Clear &Direct Formatting` を実行

.. admonition:: 利用者ノート

   これは便利なので覚える。

Calc style types
======================================================================

* セルスタイル
* 図面スタイル
* ページスタイル

Cell styles
----------------------------------------------------------------------

* セルスタイルは Writer で言う段落スタイルに似ている。
* セルスタイルはセル内のデータを書式設定する。
* セルスタイル要素の

  * 多くはメインメニュー :menuselection:`St&yles -->` 以下に示されている。
  * すべては Sidebar の :guilabel:`Styles` デッキに示されている。

.. admonition:: 読書ノート

   継承に関する記述は後でまとめて理解しよう。

Drawing styles
----------------------------------------------------------------------

* 図面スタイルは Draw で言うグラフィックスタイルに似ている。
* 図面スタイルは図形やコメントに適用される。
* スプレッドシートには Default と Note という二つの図面スタイルが定義済みだ。

  * どちらも変更可能。
  * どちらも削除不可。
  * スプレッドシートに追加した直後の図形オブジェクトには Default スタイルが適用
    されている。
  * スプレッドシートに追加した直後のコメントオブジェクトには Note スタイルが適用
    されている。

Page styles
----------------------------------------------------------------------

* ページスタイルはページではなくシートに適用される。
* シートごとに異なるページスタイルを適用可能。
* スプレッドシートには Default と Report という二つのページスタイルが定義済みだ。
* ページスタイルでは次を設定可能：

  * サイズ
  * 向き
  * 余白
  * ヘッダー
  * フッター
  * 枠線
  * 背景
  * シート印刷順序

Applying cell styles
======================================================================

セルスタイル適用方法：

* メインメニュー :menuselection:`St&yles -->` コマンド各種
* Sidebar :guilabel:`Styles` デッキ
* :guilabel:`Fill Format` モード
* :guilabel:`Formatting` ツールバー :guilabel:`Apply Style` コマンド
* キーバインド各種

Styles menu
----------------------------------------------------------------------

セルスタイルを適用するには、書式設定するセルまたはセルグループを選択し、必要なス
タイルコマンドを :menuselection:`St&yles -->` 以下から探して実行する。

Styles deck in Sidebar
----------------------------------------------------------------------

Sidebar の :guilabel:`Styles` デッキは使用可能なスタイルを一覧し、オプションでプ
レビューを表示する。

デッキの開き方は割愛。:kbd:`F11` 押しが早い。

スタイル適用手順：

#. デッキ上部にある :guilabel:`Cell Styles` を押し、一覧を開く。
#. ワークシート上でセルスタイルを適用したい対象セルを強調する。
#. :guilabel:`Styles` デッキでセルスタイル名をダブルクリックする。

Fill Format mode
----------------------------------------------------------------------

:guilabel:`Fill Format Mode` はスタイル適用したいセルがあちこちにある状況で便利
だ。

#. :guilabel:`Styles` デッキを開く。
#. セルスタイルを選択する。
#. デッキ右上にある :guilabel:`Fill Format Mode` を押す（マウスポインターに注
   目）。
#. ワークシート上で、選択セルを適用したいセルを順次クリックする。
#. 適用が完了したら :guilabel:`Fill Format Mode` を再び押す。

注意：このモード中にはワークシート上で右クリックすると、直前の Fill Format 動作
が取り消される。

Apply Style list
----------------------------------------------------------------------

:guilabel:`Apply Style` ドロップダウンリストは初期設定では
:guilabel:`Formatting` ツールバーに含まれていない。次のようにして追加する：

#. 当該ツールバーの UI のないところを右クリック。
#. 右クリックメニューから :menuselection:`Visible &Buttons --> &Apply Style` を
   オンにする。

おそらくツールバーの先頭にドロップダウンリストが現れる。これを使ってセルスタイル
を適用するには：

#. 適用したいセルをワークシートから選択。
#. 当該ドロップダウンリストを展開する。
#. 必要なスタイルを選択する。

使用中のスタイルのみドロップダウンリストに含まれる。ここにないものを使いたい場合
には :guilabel:`Mode Styles` を選べ。

Keyboard shortcuts
----------------------------------------------------------------------

Chapter 15 で述べられる方法で、よく使うスタイル適用コマンドを実行するキーバイン
ドを定義可能だ。

Applying drawing styles
----------------------------------------------------------------------

#. 対象の図形またはコメントを選択
#. Sidebar の :guilabel:`Styles` デッキに行く
#. デッキ上部 :guilabel:`Drawing Styles` をクリック
#. 必要なスタイルをダブルクリック

Applying page styles
======================================================================

スプレッドシート内のシートに適用されているページスタイルはステータスバーに示され
ている（左から三番目の区画辺りに :guilabel:`Default` などと記されている）。

#. シートを選択（シートタブ）
#. Sidebar の :guilabel:`Styles` デッキに行く
#. デッキ上部 :guilabel:`Page Styles` をクリック
#. 必要なスタイルをダブルクリック

Creating new styles
======================================================================

#. Sidebar の :guilabel:`Styles` デッキに行く
#. デッキ上部の :guilabel:`Cell Styles` ボタンなどをクリック
#. デッキで右クリックし、メニューから :guilabel:`&New...` を選択
#. ダイアログボックスで新しいスタイルの属性を設定
#. :guilabel:`OK` を押す

注意：新規スタイルにせよ既存スタイル変更にせよ、使用中のスプレッドシートにしか適
用されない。新規スタイルは雛形に保存しろ。

注意：スタイル名については大文字小文字の区別がある。

Cell style attributes
----------------------------------------------------------------------

:guilabel:`Cell Style` ダイアログボックスはタブページからなる。:guilabel:`Format
Cells` ダイアログボックスと酷似している。

Organizer tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* :guilabel:`&Inherit from` で新規スタイルを既存スタイルにリンクし、その属性の一
  部を変更することが可能になる。継承ということで、親スタイルの属性変更は子スタイ
  ルに影響が及ぶ。
* :guilabel:`&Category` から :guilabel:`Custom Styles` を選択すると新規スタイル
  を作成または編集できる。

  * :guilabel:`Styles` 一覧にしか出現させたくないスタイルに対しては
    :guilabel:`Hidden Styles` を指定しろ。

Numbers tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Font tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Font Effects tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Alignment tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Asian Typography tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Borders tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Background tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Cell Protection tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   以前の章で扱っていなければ重要事項をここにまとめる。

Resetting cell style attributes
----------------------------------------------------------------------

:guilabel:`Cell Style` ダイアログの底部ボタン群の機能は次のとおり：

* :guilabel:`&Reset` ボタンは現在のタブページ内の値をダイアログボックスが開いた
  時点に適用されていた値に戻す。
* :guilabel:`&Standard` ボタンは子スタイルの場合、現在のタブページ内の値を親スタ
  イルの設定と一致するように変更する。

Drawing style attributes
----------------------------------------------------------------------

:guilabel:`Drawing Style` ダイアログボックスは Draw における :guilabel:`Graphics
Styles` ダイアログボックスと同等だ。Draw Guide のほうに記述がある。

本文ではダイアログボックスのタブページの構成を簡潔にまとめるに留めている。

Page style attributes
----------------------------------------------------------------------

:guilabel:`Page Style` ダイアログボックスのタブページの構成を見ていく。

Organizer tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Cell Style` ダイアログボックスの同名タブページと似ている。そのページ
版という理解でいい。

Page tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

単一ページおよび複数ページのスプレッドシートのページレイアウト、ページ番号、用紙
フォーマットなど。

Borders and Background tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Cell Style` ダイアログボックスのそれと同等の設定項目に加え、背景ビッ
トマップ指定項目 :guilabel:`&Image` がある。

Header and Footer tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ページスタイルにヘッダーまたはフッターを追加する。

* ヘッダー：ページ天井の余白にテキストやグラフィックを追加可能である領域
* フッター：ページ床下の余白にある同様の領域

Chatpter 7 で詳しくやる。

Sheet tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ページスタイルを持つすべてのシートの印刷に含まれる要素を指定する。さらに、印刷順
序、最初のページ番号、ページ尺度を設定可能。

Chatpter 7 で詳しくやる。

Using themes
======================================================================

* スプレッドシートに適用できる書式設定のテーマは定義済みだ。
* 新規テーマを追加することは不可能。
* 定義済みのスタイルを変更することは不可能。
* スタイルをスプレッドシートに適用した後で変更することは可能。変更したスタイルは
  そのスプレッドシートでしか使用不可。

スプレッドシートにテーマを適用する手順：

#. メインメニュー :menuselection:`Format --> Spreadsheet Theme` などを実行
#. 適用したいテーマを選択する（即時反映される）
#. :guilabel:`&OK` を押す

スプレッドシートテーマを使用すると、スプレッドシート内の範囲を表として書式設定す
るときに効果的だ。スプレッドシートテーマを選択すると、スプレッドシートに新規セル
スタイルが追加され、既定セルスタイルが変更される。追加されるセルスタイルは：

* Column Header
* Card
* Card B (bottom)
* Card BL (bottom left)
* Card BR (bottom right)
* Card L (left)
* Card R (right)
* Card T (top)
* Card TL (top left)
* Card TR (top right)
* Background: 範囲の背景スタイル。表の辺にない表内容に適用される。
* Input: データ入力に使用するセルスタイル。
* Result2: 数式結果に対する第二選択肢。

Using spreadsheet themes
----------------------------------------------------------------------

* 文書テーマは、さまざまな書式集を一つにまとめ、すばやく適用・変更できるようにし
  たものだ。
* テーマカラーは LibreOffice 7.6 で実装された。
* フォントと書式の設定は、それ以降のリリースで実装される予定だ。

ここではテーマカラーの使用方法について述べられる。

Using document themes
----------------------------------------------------------------------

定義済みテーマカラーには Dark 1, Light 2, Accent 3 などの名前が付けられてい
る。スタイルで使用したり手動で適用したりする。

テーマを使用するようにスプレッドシートを設定するには、フォント、背景、またはオブ
ジェクトの色を、テーマカラーパレットから選択する。

* パレットの最初の行にはテーマカラーが含まれ、他の行には修正が含まれる。
* パレットのセル上にマウスポインターを置くと、その色の情報を示すツールチップが現
  れる。

テーマカラーを変更するには

#. :menuselection:`F&ormat --> Theme...` を実行
#. ダイアログボックス上で別のテーマを選択

テーマカラーとして定義された色は文書内で変更される。

既定テーマは LibreOffice (Standard) だ。

.. admonition:: 利用者ノート

   LibreOffice から Sunset の差し替えを実習しておく。

Managing styles
======================================================================

Modifying styles
----------------------------------------------------------------------

#. SideBar の :guilabel:`Style` デッキで、変更したいスタイルの型アイコンを押す
#. スタイル名の右クリックメニューから :menuselection:`&Modify...` を選択
#. スタイル属性に対して変更を加える
#. :guilabel:`&OK` を押す

.. admonition:: 利用者ノート

   シート保護の解除ができていないのか、:menuselection:`&Modify...` が見当たらな
   い。

Renaming styles
----------------------------------------------------------------------

カスタムスタイルに限り名前を変えられる。上の手順でスタイルダイアログを開いて
:guilabel:`Organizer` タブで変えろ。

Deleting styles
----------------------------------------------------------------------

カスタムスタイルに限り削除可。

* カスタムセルスタイルは適用されていない限り削除可。
* カスタムページスタイルを削除すると、影響を受けるシートは Default ページスタイ
  ルに戻る。

Hiding and showing cell styles
----------------------------------------------------------------------

セルスタイル一覧を短くするためだけの機能。割愛。

Filtering the list of styles
----------------------------------------------------------------------

スタイル一覧を短くするための真っ当な機能。デッキ底部ドロップダウンリストがフィル
ターになる。意味は見ればわかる。

What is a template? Why use one?
======================================================================

雛形を使用する大きな利点は、スプレッドシートを作成するときに、雛形のカスタムスタ
イルが新しいスプレッドシートに組み込まれることだ。

雛形には通常の文書に含まれるものなら何でも含められる。

* LibreOffice の文書はすべて雛形に基づいている。
* 新規スプレッドシートを開始するときに雛形を指定しなかった場合、その新しいスプ
  レッドシートは Calc 既定雛形に基づく。
* 既定雛形は空白のスプレッドシートで構成されており、必要に応じてカスタマイズした
  り、カスタム雛形を作成するための基として使用したりする。

Using a template to create a spreadsheet
======================================================================

利用可能なスプレッドシートの雛形がある場合、それを使用して :guilabel:`Templates`
ダイアログボックスまたは LibreOffice Start Center から新規スプレッドシートを作成
可能だ。

Creating a spreadsheet from the Templates dialog
----------------------------------------------------------------------

テンプレートを使ってスプレッドシートを作成する手順：

#. :menuselection:`&File --> &New > Te&mplates...` (:kbd:`Ctrl` + :kbd:`Shift` +
   :kbd:`N`) を選択
#. :guilabel:`Templates` ダイアログボックス上部のリストから
   :guilabel:`Spreadsheets` および所望の雛形の区分を選択する
#. 必要な雛形を選択して :guilabel:`&OK` を押す

雛形とスプレッドシートの関係は、その雛形が変更されるまで維持される。次にその雛形
に基づいたスプレッドシートを開いたとき、その修正内容に合わせてスプレッドシートを
更新するか否かを選択可能。

:guilabel:`Templates` ダイアログボックスのビュー形式を :guilabel:`List View` に
切り替えると、Modfied や Size などの付加的情報を確認できる。

Creating a spreadsheet from a template in the Start Center
----------------------------------------------------------------------

スプレッドシートは LibreOffice Start Center の :guilabel:`Template` ビューから作
成可能。さきほど述べたダイアログボックスと同じようなものだ。

Creating a template
======================================================================

どんなスプレッドシートからでも雛形を簡単に作成できる。手順：

#. 雛形の基となる新規または既存のスプレッドシートを開く。
#. 新規雛形を使用するたびに表示させたい内容を追加したり、不要な情報を削除したり
   する。
#. 雛形で使用するセル、図面、ページ各スタイルを作成または変更する。
#. :menuselection:`&File --> Te&mplates --> &Save as Template...` (:kbd:`Shift`
   + :kbd:`F11`) を実行する。
#. 新しい雛形の名前を入力し、必要な雛形区分を選択する。この雛形を既定雛形にして
   もよい。
#. :guilabel:`&Save` を押す。

または :menuselection:`&File --> Save &As...` (:kbd:`Ctrl` + :kbd:`Shift` +
:kbd:`S`) のオプションで雛形として保存することも可能。

Editing a template
======================================================================

Updating styles from a changed template
----------------------------------------------------------------------

Changing the template assigned to a document
======================================================================

Adding templates obtained from other sources
======================================================================

Installing templates
----------------------------------------------------------------------

Installing collections of templates
----------------------------------------------------------------------

Setting the default template
======================================================================

Setting a template as the default
----------------------------------------------------------------------

Resetting the default template
----------------------------------------------------------------------

Organizing templates
======================================================================

Creating a template category
----------------------------------------------------------------------

Deleting a template category
----------------------------------------------------------------------

Moving a template
----------------------------------------------------------------------

Deleting a template
----------------------------------------------------------------------

Exporting a template
----------------------------------------------------------------------
