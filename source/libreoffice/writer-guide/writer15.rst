======================================================================
Writer Guide Chapter 15, Tables of Contents, Indexes, Bibliographies ノート
======================================================================

.. include:: ./abbrev.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

この章では、LibreOffice Writerを使ってテキスト文書の目次、索引、書誌を作成し、管理する方法について説明する。他の種類の索引についても簡単に触れている。この説明を理解するためには、Writer とスタイルについて基本的な知識が必要です (第 8 章 スタイル入門および第 9 章 スタイルの操作 を参照しろ)。

Tables of contents
======================================================================

Writerの目次（TOC）機能を使えば、文書内の見出しから自動でTOCを作成できる。文書の本文や見出しが表示されているページで見出しのテキストに変更が加えられると、目次が更新されたときにその変更が自動的に表示される。

始める前に、見出しのスタイルが一貫していることを確認しろ。例えば、章の表題には見出し1のスタイルを使い、章の小見出しには見出し2と見出し3のスタイルを使うことができる。

このセクションでは、次の方法を紹介する：

- 既定を使用して、目次をすばやく作成する。
- 目次をカスタマイズする。

.. note::

   TOCに表示されるさまざまなレベルには、どのようなスタイルでも使用できる。この章の例では、既定の見出しスタイルを使用している。この章の例では既定の見出しスタイルが使用されている。7ページの「作成元」で説明されているように、TOCに表示する段落スタイルを他にも指定することができる。

.. tip::

目次に見出しが表示されない場合は、正しい段落スタイルでタグ付けされているか確認しろ。見出しのレベル全体が表示されない場合は、ツール > 見出し番号の設定を確認しろ。第8章「スタイル入門」を参照しろ。

テキストの追加や削除（見出しが別のページに移動するように）、見出しの追加、削除、変更を行った場合は、目次を更新する必要がある。これを行うには目次のどこかを右クリックし、コンテキストメニューから「索引の更新」を選択する。

TOC 内にキャレットを配置できない場合は、[ツール] > [オプション] > [LibreOffice Writer] > [書式設定補助] の順に選択し、[保護領域] セクションで [キャレットを有効にする] を選択する。

TOCは灰色の背景で表示される。この背景は、TOCがフィールドであることを思い出させるためのもので、表示されるテキストは自動的に生成される。背景は印刷されず、文書が PDF に変換された場合も表示されない。この灰色の背景をオフにするには、[ツール] > [オプション] > [LibreOffice] > [アプリケーションの色] を選択し、[テキスト文書] セクションまでスクロールダウンして、[インデックスと表の影] の選択を解除する。

この変更により、見出しとページ番号の間のドットの背後に灰色の背景が表示されることがある。この網掛けをオフにするには、[ツール] > [オプション] > [LibreOffice Writer] > [書式設定補助] を開き、[書式の表示] セクションの [タブ] オプションの選択を解除する。

Creating a table of contents quickly
----------------------------------------------------------------------

たいていの場合、既定の目次が必要なものすべてであることがわかるだろうが、書式は不便かもしれない。既定の目次を挿入するには

#. 見出しレベル（章や節の見出しなど）別に以下の段落スタイルを使用して文書を作成する：見出し1、見出し2、見出し3。これらはTOCに表示されるものだ。ライターは最大10レベルの見出しを評価できる。
#. TOCを表示したい文書をクリックする。
#. Choose Insert > Table of Contents and Index > Table of Contents, Index or Bibliography.
#. OK をクリックする。項目がハイパーリンクとして生成された典型的な目次ができあがります。

.. caution::

   文書を編集する際に、[編集] > [変更履歴] > [表示] を有効にしている場合、TOCを更新すると、削除された見出しがTOCに含まれ、削除されたテキストによってTOCのページ番号が正しく表示されないため、エラーが発生する可能性がある。この問題を避けるには、TOCを更新する前に、このオプションが選択解除されていることを確認しろ。

Customizing a table of contents
----------------------------------------------------------------------

目次は、文書のスタイルや要件に合わせてカスタマイズすることができる。

まず、既存の目次の任意の場所で右クリックし、コンテキストメニューから「索引の編集」を選択するか、TOCを表示する文書内でクリックし、「挿入」>「目次と索引」>「目次、索引、または書誌」を選択すると、図1に示す目次、索引、または書誌ダイアログボックスが開く。

目次、索引、書誌ダイアログボックスには五つのタブがある。それぞれのタブはTOCの構造と外観の異なる側面をカバーする：

* タイプタブ: TOCの属性を設定する。
* 項目とスタイルタブ: TOCの項目の書式を設定する。
* 列タブ：TOCを複数の列にする。
* 背景タブ: TOCの背景に色や画像を追加する。

ダイアログボックスの右側にあるプレビューボックスを表示するには、ダイアログボックスの左下にあるプレビューオプションを選択する。本章のイラストは、プレビューボックスを非表示にした状態でダイアログボックスを表示している。

.. note::

   プレビューボックスには、「タイプ」、「項目」、「スタイル」タブで設定した結果が表示される。列と背景タブでの変更は表示されない。

   すべての変更を行ったら、OKをクリックして適用する。列］タブと［背景］タブの設定を既定に戻すには、各タブを順番に選択して［リセット］ボタンをクリックする。タイプ、エントリー、スタイルタブの設定は手動でリセットする必要がある。

Type tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

タイプ」タブ（図1）を使って、目次の属性を設定する。

Title
   目次に別の表題を付けるには、「表題」フィールドに入力する。表題を削除するには、「表題」フィールドをクリアする。
Type
   ドロップダウン一覧でタイプを選択する。TOCの場合、TypeがTable of Contentsに設定されていることを確認しろ。他のタイプのインデックスの作成については、1二ページの「アルファベット・インデックス」と20ページの「他のタイプのインデックス」を参照しろ。

    .. note::

       インデックスのタイプを変更できるのは、最初に作成するときだけだ。いったんインデックス・タイプ（例えば目次）を定義すると、それを変更することはできない。

Protected against manual changes
   既定では、TOCが誤って変更されるのを防ぐため、このオプションが選択されている。TOCは、コンテキストメニューかダイアログボックスを使ってのみ変更できる。このオプションが選択されていない場合、TOCは他のテキストと同じように直接変更することができる。しかし、手動による変更はTOCが更新されたときに失われるので、避けるべきだ。
Create Index or Table of Contents
   この領域の [対象] ドロップダウン 一覧では、TOC が文書のすべての見出し (文書全体) をカバーするのか、または TOC が挿入されている章の見出しだけをカバーするのかを選択できる。LibreOffice の初期のバージョンでは、章を指定する見出しレベルは固定されていたが、バージョン 7.4 以降では現在の見出しレベルになる。
Evaluate up to level
   Writerでは、目次を作成する際に最大10レベルの見出しを使用できる。含まれるレベルの数を指定するには、「レベルまで評価する」ボックスに必要な数を入力する。
Create From
   タイプ」タブの3番目のセクションは、WriterがTOCの作成に何を使うかを決定する。選択肢（相互に排他的ではない）は、見出し、追加スタイル、索引マークだ。
Headings
   既定では、Writer は [ツール] > [見出し番号付け] で見出しレベルに関連付けられた段落スタイルでフォーマットされた段落を使用する。

   見出しレベルに使用する段落スタイルを変更したり、スタイルにアウトラインレベルを割り当てることで他の段落スタイルを含めることができる。これらの方法については、第8章「スタイル入門」で説明している。
Additional styles
   TOCに段落スタイルを追加することができる。これは、例えば、付録（アペンディックス）の見出しをTOCに含めたい場合に便利だ。見出し」オプションも選択されている場合、追加されたスタイルは、見出し番号で定義されたものと一緒に目次に含まれる。このオプションを選択し、スタイルの割り当てボタンをクリックすると、スタイルの割り当てダイアログボックスが開く（図2）。
Index marks
   この選択項目は、「挿入」→「目次」および「索引」→「索引エントリ」を使用して文書に挿入された索引エントリを追加する。通常、目次にこの選択を使用することはない。しかし、［索引エントリの挿入］ダイアログボックス（図3）の上部にある［索引］ドロップダウン一覧で［目次］を選択すると、Writerは索引エントリと、アルファベットやその他の索引に含めることを意図した索引エントリを区別する。

Entries tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TOCの項目を定義し、フォーマットするには、「項目」タブ（図4）を使用する。各レベルは、要素を追加したり削除したりすることで、他のレベルから独立してスタイルを設定できる。

レベル] 列の番号をクリックする。構造行には、そのレベルのエントリに含まれる要素が表示される。構造行に追加できる要素は、構造行のすぐ下に表示され、追加できない場合は灰色で表示される (たいていの場合、既に使用されているため)：

* LS 図像はハイパーリンクの開始を表する。
* N#図像は、ツール > 見出し番号設定 で見出しスタイルに割り当てられた見出し番号を表する。第8章 スタイル入門を参照しろ。
* E図像は見出しテキスト、つまり各レベルで使用される段落スタイルでフォーマットされたテキストを表する。
* T図像はタブストップを表する。
* 図像はページ番号を表する。
* LE図像はハイパーリンクの終わりを表する。
* 構造行の各白色フィールドは空白を表し、カスタムテキストや別の要素を追加できる。

.. note::

   見出し番号設定ダイアログボックス (第 8 章「スタイル入門」を参照) で、任意のレベルの [区切り記号] セクションの [前] ボックスまたは [後] ボックスにテキストが含まれている場合、そのテキストはそのレベルの N# フィールドの一部になる。構造行を作成する際は、TOC の外観に不要な効果を与えないように注意しろ。

Adding elements
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

構造線に要素を追加するには

#. エレメントを挿入したい白いフィールドをクリックする。
#. 構造線のすぐ下にあるアクティブなボタンの一つをクリックする。例えば、タブを追加するには、Tab Stop ボタンをクリックする。新しい要素を表す図像が構造行に表示される。
#. Chapterのようなカスタムテキストを追加するには、白いフィールドにテキストを入力する。末尾のスペースを忘れないでください。

Changing elements
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

構造行の要素を変更するには、その要素を表す図像をクリックし、次に構造行のすぐ下にあるボタンの列で、灰色アウトされていない要素をクリックする。例えば、章番号をタブストップに変更するには、Structure行でN#図像をクリックし（押された状態で表示される）、使用可能な要素の列でTab Stopボタンをクリックする。要素を変更する前にキャンセルするには、空白のいずれかをクリックする。

Applying changes to all levels
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

すべてのレベルに同じ構造とフォーマットを適用したい場合は、右側の「すべて」ボタンをクリックする。

Deleting elements
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

構造行から要素を削除するには、その要素を表すボタンをクリックし、キーボードのDeleteキーを押する。例えば、既定のハイパーリンク設定を削除するには、LS図像をクリックし、Deleteキーを押する。これをLE図像についても繰り返する。

Applying character styles
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ある要素を、他の行とは少し違ったものにしたい場合もあるだろう。例えば、ページ番号を太字にしたい場合などだ。要素に文字スタイルを適用するには

#. 適切な文字スタイルが定義されていることを確認する。
#. 構造行で、スタイルを適用したい要素を表すボタンをクリックする。
#. 文字スタイル ドロップダウン一覧で、必要なスタイルを選択する。

キャラクタ スタイルの属性を表示または編集するには、キャラクタ スタイル ドロップダウン 一覧でスタイルを選択し、［編集（Edit）］ボタンをクリックする。

.. tip::

   ハイパーリンク（「挿入」→「ハイパーリンク」で挿入したものなど）の既定の文字スタイルは「インターネットリンク」で、既定では下線が引かれ、青色で表示される。

   TOCエントリーの既定のハイパーリンクはインデックスリンクの文字スタイルに設定されており、インターネットリンクのスタイルとは見た目が異なる場合がある。インターネットリンクと同じように表示させたい場合は、構造行のLS図像を選択し、TOCエントリーの文字スタイルの選択をインターネットリンクに変更することができる。

   また、インデックス・リンクの属性を変更することもできる。

Tab parameters
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

構造線のタブストップの図像をクリックすると、これらのコントロールが表示される：

* 塗りつぶし文字：使用するタブ文字を選択する。
* タブストップの位置：左ページ余白とタブストップの間の距離を指定する。オプションで、タブストップの位置を右に揃えるを選択する。

Tab position relative to paragraph style indent
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

このオプションを選択すると、個々の書式の設定に従って項目が字下げされる。段落スタイルで左字下げが指定されている場合、タブストップはこの字下げからの相対位置となる。このオプションが選択されていない場合、タブストップは左余白位置からの相対値となる。

Styles tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイル］タブ（図5）を使用して、目次の各レベルのテキストを表示するために割り当てる段落スタイルを変更する。ほとんどの場合、割り当てられたスタイルはそのままに、必要に応じて設定を変更し、TOCを思い通りに表示するのが最善の方法だ。

カスタム段落スタイルをアウトラインレベルに適用するには

#. ［レベル］一覧で、レベルを選択する。
#. ［段落スタイル］一覧で、必要な段落スタイルをクリックする。
#. < ボタンをクリックして、選択した段落スタイルを選択したアウトライン レベルに適用する。

各レベルに割り当てられたスタイルは、[レベル] 一覧の角括弧内に表示される。

アウトライン・レベルから段落スタイルを削除するには、[レベル] 一覧でアウトライン・レベルを選択し、[既定] ボタンをクリックする。

段落スタイルの属性を表示または編集するには、［段落スタイル］一覧でスタイルをクリックし、［編集］ボタンをクリックする。

Columns tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TOCの列数を変更するには「列」タブを使用する。複数の列はTOCよりもインデックスで使われる可能性が高いので、このタブはインデックスのセクションで説明する。図10を参照。

Background tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TOCの背景に色や画像を追加するには、「背景」タブ（図6）を使用する。第6章「ページの書式設定」を参照しろ：背景の追加については、第6章「ページの書式設定：詳細」を参照しろ。

Adding color
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

目次の背景に色を追加するには、ダイアログボックスの上部にある「色」ボタンを選択し、提供されている色から選択して「OK」をクリックする。

カスタム背景色の定義については、第20章Writerのカスタマイズを参照しろ。

Adding an image
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

目次の背景に画像を追加するには、画像ボタンを選択する。背景タブに画像オプションが表示される。

Deleting a color or an image
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

テーブルの背景から色や画像を削除するには、ダイアログボックスの上部で「なし」を選択する。

Editing a table of contents
----------------------------------------------------------------------

既存のTOCを編集するには、TOC内の任意の場所を右クリックし、コンテキストメニューから「索引の編集」を選択する。また、Sidebarのナビゲータを開き、「索引」の横にある拡張記号（＋印または三角印）をクリックし、「目次」をダブルクリックすることもできる。

目次、索引、書誌ダイアログボックス（6ページの図1）が開く。前のセクションで説明したように、TOCを編集・保存することができる。

Updating a table of contents
----------------------------------------------------------------------

Writerは自動的にTOCを更新しないので、文書の見出しを変更した後は、手動でTOCを更新する必要がある。TOCの任意の箇所を右クリックし、コンテキストメニューから「索引の更新」を選択する。

ナビゲータから索引を更新することもできる：「索引」を展開し、更新したい目次名を右クリックし、「索引」>「更新」を選択する。

Deleting a table of contents
----------------------------------------------------------------------

文書からTOCを削除するには、TOCの任意の場所を右クリックし、コンテキストメニューから「インデックスの削除」を選択する。また、ナビゲーターからインデックスを削除するには、図エラーに示すメニューから「インデックス」>「削除」を選択する：参照元が見つかりません。Writerは削除を確認するプロンプトを出しない。

Alphabetic indexes
======================================================================

アルファベット順の索引は、文書中で使用されているキーワードやフレーズの一覧で、ページ番号順に記載されていれば、読者が情報をすばやく見つけるのに役立つ。一般的に、索引は本や文書の後ろにある。

このセクションでは、以下の方法について説明する：

* インデックス項目を手動で追加する。
* コンコーダンスファイルを使用する。
* アルファベット索引をすばやく作成する。
* 索引項目の表示をカスタマイズする。
* インデックスの外観をカスタマイズする。
* 既存の索引項目を表示・編集する。

Adding index entries
----------------------------------------------------------------------

インデックスを作成する前に、手作業で、あるいはコンコーダンス (14 ページ参照) を使って、いくつかのインデックス項目を作成する必要がある。手動で索引項目を作成するには

#. 単語をインデックスに追加するには、その単語のどこかにキャレットを置きます。複数の連続する単語を 1 つの項目として追加するには、フレーズ全体を選択する。
#. ［挿入］→［目次と索引］→［索引エントリ］を選ぶか、または［挿入］ ツールバーの［索引エントリの挿入］図像をクリックして、図 7 のようなダイアログボックスを表示する。ダイアログボックスが開くと、選択したテキストが「入力」ボックスに表示される。表示された単語や語句をそのまま受け入れることもできるし、 好きなものに変更することもできる。
#. 挿入をクリックして項目を作成する。

.. tip::

   単語の最初の文字の直前、または単語の最後の文字の直後にキャレットが置かれた場合、そのキャレットはその単語の中にあるとみなされる。

ダイアログボックスを閉じることなく、複数のエントリーを作成することができる。それぞれについて

#. インデックスを作成したい文書の場所をクリックする。
#. ダイアログボックス上でもう一度クリックする。
#. 必要に応じて項目を変更し、挿入をクリックする。
#. エントリーが終了するまでステップ 1 ～ 3 を繰り返し、[閉じる] をクリックする。

以下は、「Insert Index Entry」ダイアログボックスのフィールドとその使い方についての簡単な説明だ。

Index
   このエントリーのインデックスのタイプ。既定はAlphabetical Indexだが、このフィールドを使用して、目次や使用者定義の索引や一覧のための追加エントリを作成することができる。例えば、本文中で言及されている種の学名のみを含む索引と、種の通称名のみを含む別の索引が欲しいかもしれない。20ページの「その他の索引」を参照。
Entry
   選択した索引に追加する語句。この語句は文書そのものに含まれている必要はなく、同義語や索引に表示させたい他の用語を追加することができる。
1st key
   インデックス・キーとは、関連するページ番号を持たず、ページ番号を持ついくつかのサブエントリーを持つエントリーのことだ。キーを使うと、関連するトピックをグループ化するのに便利だ。(14ページの「インデックスキーの使用例」を参照)。
2nd key
   最大で3レベルのインデックスを持つことができ、第1レベルのキーのいくつかは、（ページ番号を持たない）キーでもある第2レベルのエントリーを持つ。この程度のインデックスの複雑さは、あまり必要ではない。
Main entry
   同じ用語が複数のページに索引付けされている場合、そのうちの一つのページにそのトピックに関するより重要な情報や詳細な情報があることが多いので、そのページをメイン・エントリーにしたいものだ。メイン・エントリ、つまり最も重要なエントリのページ番号を目立たせるには、このオプションを選択し、メイン・インデックス・エントリのページ番号の文字スタイルを太字などに定義する。
Apply to all similar texts
   このオプションを選択すると、Writerが現在の選択範囲に一致する他の単語や語句を自動的に識別してマークする。このオプションを選択すると、「大文字と小文字を一致させる」と「単語全体のみを一致させる」オプションが使用できるようになる。このオプションを使用すると、不要なページ番号（その単語のマイナーな用法）が索引に多数記載される可能性があるため、注意しろ。

Example of using an index key
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

インデックス・キーは、サブエントリーをグループ化するための主エントリーだ。例えば、次のようなグループ分けをしたいだろう：

.. code:: text

   LibreOffice
         Calc,  10
         Impress,  15
         Writer,  5

この例では、LibreOfficeが1番目のキーだ。サブエントリ (ページ番号が表示されている) が索引エントリだ。トピック Writer の索引項目を挿入するには、[索引項目の挿入] ダイアログボックス (13 ページの図 7) で、[項目] ボックスに Writer と入力し、[1 番目のキー] ボックスに LibreOffice と入力する。

.. note::

   フィールドシェーディングが有効な場合 (ツール > オプション > LibreOffice > アプリケーションの色 > テキスト文書 > フィールドシェーディング)、選択した語句が索引に追加されると、その語句の背景が灰色でテキストに表示される。索引項目のテキストが選択した単語のテキストから変更されている場合、索引項目はその単語の先頭または末尾に小さな灰色の四角形でマークされる。

Creating a concordance
----------------------------------------------------------------------

コンコーダンスは、索引に追加する単語を列挙したプレーン・テキスト・ファイルである。各行に一つの単語または語句が定義されている。各行はセミコロンで区切られた7つのフィールドからなる厳密な構造を持っている：

.. code:: text

   Search_term;Alternative_entry;1st_key;2nd_key;Match_case;Word_only

セミコロンとフィールドの内容の間にはスペースを入れない。キーとは、検索語がその下に置かれる上位の見出しのことだ。

代替項目、最初のキー、2番目のキーを設けない場合は、これらのフィールドを空白のままにして、セミコロンが別のフィールドの直後に来るようにする。

最後の二つのフィールドは多少異なる構造になっている。エントリーと同じ大文字または小文字を持つエントリーだけが欲しい場合は、最後から2番目のフィールドに1を入力する。同様に、最後のフィールドに1を入力すると、エントリーが単語全体であり、大きな単語の一部でない場合のみをインデックスに含めるように設定する。最後の二つのフィールドを空白にすることもできる。

例えば

.. code:: text

   Macaw;Ara;Parrots;;0;0

でコンゴウインコのエントリが作成される:

* コンゴウインコの下の一覧。
* アラ（学名）の下の一覧。
* オウム, コンゴウインコの一覧。
* 2番目のキーなし（二つのセミコロンに注意）。
* 小文字または大文字（"macaw "と "Macaw "の両方）で始まる例を含む。
* 単語全体または長い単語の一部である場合。

コンコーダンスが手作業で項目を追加するよりも速いかどうかは議論の余地があるが、コンコーダンスがより体系的であることは確かである。コンコーダンスの欠点は、目的とは無関係な一般的な単語の例を含む索引が作成される可能性があることである。多くの場合、有用な索引を作るには、手入力とコンコーダンスとの組み合わせが必要かもしれない。

Creating an alphabetic index quickly
----------------------------------------------------------------------

インデックス・エントリがいくつかできたので、インデックスを作成することができる。

インデックスはWriterで広範囲にカスタマイズすることができるが、ほとんどの場合、いくつかの選択をするだけだ。

インデックスをすばやく作成するには

#. 索引を追加したい文書内でクリックし、［挿入］→［目次と索引］→［目次、索引、 書誌］の順にクリックして、［目次、索引、書誌］ダイアログボックスを開く。
#. ［タイプ］タブの［タイプ］ボックスで（図8）、［アルファベット順インデックス］を選択する。
#. 「オプション」セクションで、「大文字と小文字を区別する」（大文字と小文字の単語を同じ単語として扱う）と「同じ項目をpまたはppで結合する」の選択を外すことを検討する。
#. コンコーダンスを使用する場合は、オプション・セクションでコンコーダンス・ファイルを選択し、ファイル・ボタンをクリックして、作成したコンコーダンス・ファイルを選択する。
#. OKをクリックする。典型的な索引ができあがります。

Customizing an index
----------------------------------------------------------------------

既存のインデックスをカスタマイズするには、インデックス内の任意の場所を右クリックし、コンテキストメニューから「インデックスの編集」を選択する。

目次・索引・書誌ダイアログボックス（図8）には五つのタブがある。これらのタブはすべて索引をカスタマイズするために使用することができる。

* タイプタブ: インデックスの属性を設定する。
* 項目とスタイルタブ: インデックスの項目をフォーマットする。
* 列タブ: インデックスを複数の列に配置する。
* 背景タブ: インデックスの背景に色や画像を追加する。

変更後、OKをクリックしてインデックスを保存し、文書に表示されるようにする。

Type tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

インデックスの基本属性を設定するには、「タイプ」タブ（図8）を使用する。

インデックスに別の表題を付けるには、「表題」フィールドを編集する。表題を削除するには、「表題」フィールドをクリアする。

インデックスのタイプがAlphabetical Indexに設定されていることを確認しろ。

既定では、インデックスが誤って変更されるのを防ぐために、「手動変更から保護」オプションが選択されている。このオプションが選択されていない場合、インデックスは他のテキストと同じように直接変更することができるが、インデックスへの手動による変更はインデックスが更新されたときに失われるので、避けるべきだ。

索引または目次の作成」セクションのドロップダウン一覧で、「文書全体」を選択するか、「現在の章だけの索引を作成する」を選択する。

その他のオプションは、インデックスがどのようにエントリを処理するかを決定する。

Combine identical entries
   同一エントリーをどのように扱うかを定義する。通常、索引付けされた単語や語句の各ページ番号が索引に表示される。しかし、Combine identical entries with pまたはppを使って、これらを結合することができる。

   ページ範囲を表示したい場合は、Combine with -を選択する（23-31のようなものが表示される）。どの文字が大文字かによって異なるエントリーを含めるには、Case sensitiveを選択する。
AutoCapitalize entries
   文書内の用語の表示に関係なく、各項目の最初の文字を自動的に大文字にする。
Keys as separate entries
   インデックス・キーに独自のページ番号を付けるには、このオプションを選択する。
Concordance file
   使用するコンコーダンス・ファイルがあれば、それを選択する。詳しくは14ページを参照。
Sort
   エントリーを表示する際のソート方法を定義する。唯一のオプションは英数字だが、どの言語のアルファベットを使うかを定義できる。

Entries tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Entries]タブを使用して、各エントリーの表示方法と内容を正確に設定する。このタブは図9に似ている。

.. note::

   Writer 7.6では、索引から本文中のエントリーの場所へのハイパーリンクが新たに追加された。

はじめに、「レベル」列で、要素をフォーマットしたいインデックス・レベルを選択する。レベル "S "は、[フォーマット]セクションで[アルファベット区切り]オプションが選択されている場合に、インデックス・エントリをアルファベット順に分割する1文字の見出しを指する。(後ですべてのインデックス・レベルに変更を適用できる。) [構造とフォーマット] セクションの [構造] 行には、そのレベルのエントリの要素が表示される。行の各ボタンは、1 つの要素を表する：

* E図像は入力テキストを表す。
* T図像はタブストップ。
* 図像はページ番号を表す。
* HI図像は章情報を表す。これは既定では存在しないが、見出し情報ボタンを選択することで追加できる。

構造行の各白フィールドは空白を表す。目次については9ページで説明したように、要素を追加、変更、削除することができる。

Heading Info
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

見出し情報ボタンは、このオプションが選択されたときに表示される見出し情報一覧から選択された見出し番号や内容などの見出し情報を挿入する。見出し情報は、ツール > 見出し番号で指定する。

Applying character styles
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

構造行の各要素には、追加の書式を指定することができる。例えば、ページ番号を他の索引テキストと異なるサイズにしたい場合がある。これを行うには、目次 (10ページ)のように、構造行の要素の一つに文字スタイルを適用する。

Formatting entries
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

書式」セクションのオプションを使用して、さらに書式を適用する。

Alphabetical delimiter
   これは、インデックス・エントリーを、同じ最初の文字で始まるブロックに分け、その文字をヘッダーとして使用するものである。例えば、インデックスが

   .. code:: text

      apple,  4
      author, 10
      break,  2
      bus, 4

   そして、このオプションを選択すると:

   .. code:: text

      A
      apple,  4
      author, 10

      B
      break,  2
      bus, 4

Key separated by commas
   インデックスのエントリーを同じ行に並べるが、カンマで区切る。
Tab position relative to Paragraph Style indent
   選択された場合、項目はそれぞれの書式の設定に従って字下げされる。左字下げのある段落スタイルが使用されている場合、タブストップはこの字下げに対して相対的になる。このオプションが選択されていない場合、タブストップは左余白位置に対して相対的になる。

Styles and Background tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイル] タブを使用して、インデックスの各レベルのテキスト表示に割り当てる段落スタイルを変更する。ほとんどの場合、割り当てられたスタイルはそのままに、必要に応じて設定を変更することで、インデックスを思い通りに表示することができる。

背景」タブはTOCと同じだ。これらのタブの詳細については、1一ページの「スタイルタブ」と1一ページの「背景タブ」を参照しろ。

Columns tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

列タブ（図10）を使用して、インデックスの列数を変更する。

Adding multiple columns
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

複数の列にインデックスを表示するには

#. 「Columns」と書かれたボックスに希望の列数を入力するか、列数を表す図像を選択する。
#. ページ幅に応じて列を均等に配置するには、AutoWidth ボックスを選択する。チェックが入っていない場合は、以下の各項目を手動で設定することができる：

   * 各列の幅
   * 列間の間隔
#. 列と列の間に区切り線を入れる：

   * スタイル：既定は「なし」、または三つの線スタイルから選択。
   * 幅：線の幅（太さ）。既定は0.25ptだ。
   * 色：区切り線の色を選択する。既定は黒だ。
   * 高さ：行の高さを列全体の高さに対するパーセンテージで指定する。既定は100%だ。
   * 位置：高さが100%未満の場合、列に対する線の位置（上部、中央、下部）。

Maintaining an index
----------------------------------------------------------------------

インデックスの外観を変更するには、インデックスの任意の場所を右クリックし、コンテキストメニューから「インデックスの編集」を選択する。目次、索引、書誌ダイアログボックスが開き、前のセクションで説明した五つのタブを使用して索引を編集・保存することができる。

索引を更新または削除するには、索引内の任意の場所で右クリックし、「索引の更新」または「索引の削除」を選択する。

Viewing and editing existing index entries
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

最初のエントリーを追加したら、いくつかの修正を加えることができる。以下の手順で、これらを表示および編集することができる：

#. フィールドシェーディングがアクティブになっていることを確認する（View > Field ShadingsまたはCtrl+F8）。
#. 文書本文の既存の索引項目のフィールド網掛けにキャレットを置き、右クリックして、内容メニューから索引項目の編集を選択する。変更されたテキストエントリーの場合、フィールドの網掛けは単語の直前になる。テキスト項目としてマークされた単語の直前にキャレットを置くと、両方の選択条件を満たすことになる。
#. 図11のようなダイアログボックスが表示される。進む矢印ボタンと戻る矢印ボタンを使って、さまざまな索引項目を移動することができる。一つの単語や語句に複数のエントリーがある場合は、矢印の頭に垂直のバーが付いた二列目のボタンが表示され、それぞれのエントリーをスクロールすることができる。
#. インデックス項目に必要な修正や追加を行い、OKをクリックする。

Other types of index
======================================================================

Writerが作成できる索引の種類は、アルファベット索引だけではない。他にも、図、表、オブジェクトの索引があり、使用者定義の索引を作成することもできる。この章では、すべての可能性について例を挙げているわけではない。

他のインデックスを作成するには

#. 索引を作成したい場所にキャレットを置く。
#. メニューの「挿入」→「目次と索引」→「目次、索引または書誌」を選択。
#. 「目次、索引、書誌」ダイアログボックスの「タイプ」ドロップダウン一覧で、希望する索引を選択する。
#. 前のセクションで説明したのと同様の、さまざまなタブを修正する。
#. すべて設定したら OK をクリックする。

Example: Creating a table of figures
----------------------------------------------------------------------

挿入＞キャプションを使用するか、第17章「フィールド」で説明するように数値範囲変数を使用して手動で図のキャプションを作成した場合、図や表の表を作成するのは簡単だ。

#. 目次，索引または書誌ダイアログボックスの［タイプ］ドロップダウン一覧で，［図 表］を選択する．オプションで、表題を変更する。
#. Create FromセクションでCaptionsが選択されていることを確認し、キャプションの区分を選択する。Categoryの既定はFigureで、この例ではキャプションにFigureを使用している。
#. 表示のところで、参照（区分、番号、キャプションテキストを含む）、区分と番号、キャプションテキストを選択できる。ここではReferencesを選択した。
#. オプションで「追加の段落スタイルから作成」を選択し、一覧からスタイルを選択する。
#. このダイアログボックスの他のタブは、目次について説明したものと同様だ。
#. OK をクリックする。結果を図 13 に示す。

Bibliographies
======================================================================

書誌とは、文書の中で使われている参考文献の一覧である。参考文献は、書誌データベースに保存することも、文書自体に保存することもできる。

このトピックでは、Writerの機能を使用する方法を説明する：

* 書誌データベースを作成し、エントリを追加および管理する。
* 文書に参考文献（引用）を追加する。
* 書誌の書式を設定する。
* 既存の書誌を更新および編集する。

Citation styles and the bibliographic database
----------------------------------------------------------------------

引用（参考文献）は文書内でも作成できるが、書誌データベースを作成することで、他の文書での再利用が可能になり、多くの時間を節約することができる。

本文中の引用は、書誌データベースの異なるフィールドへの入力と、本文中の異なる表示が必要だ。参考文献一覧を作成する前に、文書に必要な引用スタイルを決めましょう。主なスタイルは次の五つです：

* APA（アメリカ心理学会）：心理学、教育学、その他の社会科学。
* MLA（Modern Languages Association）：現代言語学会：文学、芸術、人文科学。
* シカゴ：歴史と特定の出版物。
* Turabian（トゥラビアン）：大学生が一般的に使用するChicagoスタイルのバリエーション。
* AMA（米国医師会）：医学、健康、生物学。

書誌データベース（図14）は、どのような引用スタイルを使用する場合でも、本文中の引用のソースとなる。

すべての引用は、Identifier フィールドを使用して、文書内の引用の形式を設定する。この欄に、引用スタイルに適した形式で引用を追加する。Identifierフィールドを含むすべての必要な情報は、文書内で引用を作成する前に入力する必要がある。

.. tip::

   Writerには、すべての文書に単一の書誌データベースがある。書式を設定するのは面倒なので、資料の種類ごとに引用の雛形を作成することをお勧めする。

Creating a bibliographic database
----------------------------------------------------------------------

このトピックの大部分では、Writerに付属しているサンプルのデータベーステーブルを使用している。書誌データベースに新しいテーブルを作成する方法については、『入門ガイド』を参照しろ。

書誌データベースは、さまざまなメディアや状況をカバーしなければならないため、非常に多くのフィールドを含んでいる。また、ISBNのような、引用スタイルでは使用されないが、研究中に役に立つかもしれないフィールドも含まれている。

.. note::

   どのような引用形式を使っても、書誌に記入する項目は約半ダースで済みます。異なるのは、資料の種類ごとに必要なフィールドと、各引用スタイルにおけるフィールドの順序だ。

データベースを開くには、[Tools] > [Bibliography Database] を選択する。図14のような書誌データベースウィンドウが開く。タブの上部には、スプレッドシートに似た表レイアウトで、すべてのレコードが表示される。タブの下部には、選択したレコードのすべてのフィールドが表示される。

.. note::

   データベーステーブルのIdentifierカラムとテーブルの下のShort Nameフィールドは同じフィールドである。サンプルデータベースのこれらのフィールドのサンプルエントリは無意味だ。使用する引用スタイルに適した書式に置き換えてください。

Changing the data source
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

使用中のデータソースを変更するには（たとえば、異なる目的のために複数の書誌データベースを使用している場合）、メニューで「データ」>「データソースを選択」を選択するか、データベースウィンドウの上部付近にあるツールバーの「データソース」ボタンをクリックする。データソースの選択」ダイアログボックスに、登録済みのデータソースが一覧表示される。その中から一つを選択し、OKをクリックする。

別のデータ・ソースを追加（登録）するには、『入門ガイド』の説明を参照しろ。

Filtering records
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

書誌データベース内の特定のレコードにフィルタを設定するには、書誌データベースのメニ ューバーで［データ］＞［フィルタ］を選択するか、ウィンドウ上部付近のツールバーで［標準 フィルタ］ボタンをクリックする。標準フィルタ」ダイアログボックス（図15）で、フィルタのフィールド、条件、値を選択し、「OK」をクリックする。

Adding entries to the database
----------------------------------------------------------------------

エントリーを書誌データベースに追加するには、データベースのデータソースビューを使用する方法と、書誌データベースウィンドウを使用する方法の二つの方法がある。

書誌データベースのデータソースビューを使用してエントリを追加するには、以下の手順に従いる：

#. メニューの「表示」>「データソース」を選択するか、Shift+Ctrl+F4 キーを押して、図 16 のようなデータソースウィンドウを開く。
#. 書誌データベースで正しいテーブルが選択されていることを確認する。正しいテーブルを選択するために、いくつかのレベルを展開する必要があるかもしれない。
#. 一覧の一番下までスクロールし、該当するフィールドに空行で入力する。左上の「現在のレコードを保存」図像がアクティブになる。これをクリックして、データベースに追加を保存する。

書誌データベース]ウィンドウを使用してエントリを追加するには：

#. メニューの Tools > Bibliography Database を選択する。23 ページの図 14 に示すウィンドウが開く。
#. ウィンドウのメニューで［データ］>［記録］を選択するか、横 スクロールバーの左にある＋図像をクリックする。
#. ショートネームボックスにエントリーの名前を入力する。必要に応じて他のフィールドも入力する。
#. エントリーを完成させてデータベースに追加するには、テーブルの他のセルをクリックする。

Maintaining entries in the database
----------------------------------------------------------------------

データベース内のエントリーを管理するには、データソース・ビューまたは書誌データベース・ウィンドウのいずれかを使用する。適切なレコードを選択し、必要に応じてフィールドを変更する。

変更された項目は、キャレットがレコードから移動すると自動的にデータベースに保存される。

Advanced: Modifying the bibliographic database
----------------------------------------------------------------------

書誌データベースは、以下のようにいくつかの方法で変更することができる。

.. note::

   LibreOffice のデータベース機能の使い方の詳細については、入門ガイドを参照しろ。

Column details
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

書誌データベースの列の詳細を変更するには、メニューの「データ」→「列の配置」を選択するか、ウィンドウ上部付近のツールバーの「列の配置」ボタンをクリックする（図14）。列のレイアウトダイアログボックス（図17）では、どのフィールドを列に割り当てるかを変更することができる。たとえば、ドロップダウン一覧の行き先を変更することで、AuthorデータをIdentifier列に入れるように選択できる。短い名前データの列の行き先は、データの行き先が重複しないように、自動的に<none>に設定される。

Field details
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

書誌データベースに変更を加えるには（例えば、フィールド名の変更やフィールドの長さの変更など）、次のようにする：

#. メイン文書（書誌データベースウィンドウではない）で、Shift+Ctrl+F4 を押すか、View > Data Sources をクリックして、図 16 のようなデータソースウィンドウを開く。
#. 書誌データベースが選択されていることと、正しいテーブルが選択されていることを確認する。
#. テーブルエントリ (例では biblio) を右クリックし、コンテキストメニューからデータベースファイルの編集 を選択する。図 18 のようなウィンドウが開くが、これは LibreOffice のデータベースコンポーネントである Base のメインメニューだ。
#. テーブル (左側のデータベースセクション) が選択されていない場合は、選択する。
#. Tablesセクションのbiblioテーブル名を右クリックし、コンテキストメニューからEditを選択すると、図19のようなウィンドウが表示される。
#. これで各フィールドを選択できる。フィールド名」セルのテキストを選択し、必要に応じて入力を変更する。Field Typeセルをクリックして選択メニューを開き、そのセルのデータ型を変更する。Field Propertiesセクションでは、データ・プロパティを変更することができる。選択された各フィールドについて、そのフィールドの説明がセクションの右に表示される。
#. 完了すると、変更を保存するかどうかの確認が求められる。

Adding references (citations) into a document
----------------------------------------------------------------------

Writerは、文書に参考文献を追加する二つの方法をサポートしている：

* Writerに組み込まれているような書誌データベースから。
* キーボードから直接。

Entering references from a database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

書誌データベースから文献を文書に追加するには

#. キャレットを参照したい場所に置く。
#. On the Menu bar, choose Insert > Table of Contents and Index > Bibliography Entry.
#. ［書誌エントリの挿入］ダイアログボックス（図 20）で，ダイアログボックス上部の［書誌 ソース］セクションで［書誌データベース］を選択する．
#. ダイアログボックス中央の Short name ドロップダウン一覧から文献を選択する。選択した文献の著者名と表題は、それが必要な文献であることを確認するために、Short name フィールドの下に表示される。
#. 文書に参考文献を挿入するには、Insert をクリックする。ダイアログボックスを閉じて開き直す必要はない。
#. すべての参照を挿入し終わったら、閉じるをクリックする。

Entering references from documents
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

外部データベースからではなく、文書に直接書誌項目を入力することもできる。エントリーを追加したい文書をクリックする。

#. Select Insert > Table of Contents and Index > Bibliography Entry.
#. In the Insert Bibliography Entry dialog (Figure 20), select Document content in the Bibliography Source section at the top of the dialog.
#. Click New to open the Define Bibliography Entry dialog.

   #. エントリーに関連するフィールドをすべて入力する。書誌エントリの挿入ダイアログボックスでは、このエントリが引用に使用される。
   #. タイプボックスのメニューからオプションを選択し、OKボタンを有効にする。
   #. すべての入力が完了したら、OKをクリックする。
   #. 挿入]をクリックして[短い名前]フィールドを文書に追加し、[閉じる]をクリックする。

文書内のエントリーを再利用するには、上記の手順を再開し、新しいエントリーを追加することを選択する代わりに、現在のエントリーの一覧から必要なショートネームを選択する。

Editing a reference
----------------------------------------------------------------------

参照を編集するには

#. 項目を右クリックする（キャレットが項目の左に表示される）。
#. コンテキストメニューで、書誌エントリを選択する。書誌エントリの編集ダイアログボックス（書誌エントリの挿入ダイアログボックスに類似）が開く。
#. 短い名前だけを素早く編集するには、テキストボックスをクリックし、エントリーを編集し、適用をクリックする。
#. エントリーの詳細を編集するには、EditをクリックしてDefine Bibliography Entryダイアログボックスを開く。

   必要な変更を行い、OKをクリックして書誌エントリーの編集ダイアログボックスに戻る。
#. ［Apply］をクリックして変更を承認し、ダイアログボックスを閉じる。

.. note::

   変更された参照は、文書にのみ保存される。ソースが書誌データベースの場合、そのデータベースは変更されずに残ります。

Creating the bibliography
----------------------------------------------------------------------

#. 書誌を挿入したい箇所にキャレットを置く。
#. [挿入] > [目次と索引] > [目次、索引または書誌] を選択し、[タイプ] を [書誌] に変更すると、図 21 のようなダイアログボックスが表示される。

Type tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writerは、文書の本文中に参考文献（引用）を表示する二つの方法をサポートしている：

* 各書誌エントリーのShort nameフィールドに記録されたテキストを使用する（例：Smith, 2001）。
* 例えば、[1]。

.. tip::

   文書内で使用する引用スタイルを指定するには、目次、索引、書誌ダイアログボックスの「タイプ」タブを使用する（図21）。

書誌の書式は二つの場所で選択する：

* 目次、索引、書誌ダイアログボックス。
* 書誌1段落スタイル（30ページ参照）。

基本設定は「タイプ」タブで選択する。

#. 書誌に表題を付けるには、表題フィールドに入力する。(表題は必須ではない）。
#. 手動による変更から保護するを選択すると、書誌が誤って変更されるのを防ぐことができる。このオプションを選択すると、書誌は右クリックメニューまたは目次、索引、書誌ダイアログボックスでのみ変更できるようになる。このオプションが選択されていない場合、書誌は他のテキストと同様に文書ページで直接変更できるが、手動で変更した内容は書誌を更新したときに失われる。
#. 書誌項目(引用)に文書本文内で番号(例えば、[1]、[2]...)を付けるには、Number entries を選択する。ただし、(データベースからの)Short nameフィールドの内容を文書内に表示したい場合は、このオプションを選択解除しろ。
#. 文書の本文中に表示される参照される項目の括弧の種類を選択する。
#. 必要な並べ替えを定義する。現在のところ、英数字によるソートのみがサポートされている。エントリが本文に表示される順序による並べ替えは、Entries タブで行いる。

Entries tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Entries」タブ（図 22）の構造は、目次や索引の構造と似ている。

タイプ」セクションは、書籍、定期刊行物、ウェブページなど、ソースの種類を示す。タイプ] 一覧の各エントリには、既定の構造形式がある。エントリーのType一覧から選択することで、そのソースに基づいて、エントリーがどのように表示されるかを定義することもできるし、単にAllボタンをクリックしてすべてのエントリーに同じフォーマットを適用することもできる。

エントリーの構造は、書誌データベースで利用可能なフィールドに基づいている。文書に必要な引用スタイルを参照し、必要に応じて構造行を修正しろ。

構造行から要素を削除するには、要素をクリックし、削除ボタンをクリックする。

要素を追加するには、挿入する構造行をクリックする。タブストップ」または「挿入」ボタンの左側にあるドロップダウン一覧の要素を選択し、「挿入」をクリックする。ドロップダウン一覧の要素は、書誌データベースにあるフィールドだ。

構造行のすべての要素は、文字スタイル選択一覧を使って書式設定できる。たとえば、書籍やジャーナルの表題がイタリック体や太字になるように文字スタイルを定義できる。

エントリの並べ替え方法を決定するには、Sort byオプションを変更する。項目がテキストに表示される順序で並べ替えるには、「文書の位置」を選択する。ほとんどの最新の引用スタイルでは、Content（アルファベット降順）を選択する。類似の文献をグループ化するには、並べ替えキーを使用する。

Styles, Columns and Background tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

これらのタブの詳細については、1一ページの「スタイルタブ」、18ページの「カラムタブ」、1一ページの「背景タブ」を参照しろ。

Modifying the paragraph style for the bibliography
----------------------------------------------------------------------

要件に合わせて書誌1段落スタイルを変更することができる。例えば、書誌一覧の項目に番号を付けるには、一覧スタイルを定義し、その一覧スタイルを書誌1段落スタイルにリンクする必要がある。これを行うには

1) Sidebarのスタイル甲板で、一覧スタイル図像をクリックする。Numbering 123］を右クリックし、コンテキストメニューから［New］を選択する。
2) ［一覧 スタイル］ダイアログボックスの［オーガナイザー］タブで、このスタイルの名前を入力する。この例では「Bibliography」と名付けました。
3) この例では、数字を角括弧で囲みます。これを行うには、図23に示すように、「カスタマイズ」タブを開き、「前」ボックスに[ を、「後」ボックスに]を入力する。ピリオドなど、他の句読点が「後」ボックスに入っている場合は削除しろ。
4) 次に、［一覧・スタイル］ダイアログボックスの［位置］タブを開く（図24）。Indent atとTab stop atのボックスで、文書の書誌一覧の項目の2行目以降の字下げ量を指定する。多くの場合、最適な設定を確認するために少し試す必要がある。この例では1cmにした。
5) OK をクリックしてこれらの設定を保存し、一覧スタイルダイアログボックスを閉じる。スタイル］甲板に戻り、［段落スタイル］図像をクリックし、ウィンドウ下部の一覧で［すべてのスタイル］を選択し、［書誌1］を右クリックして［修正］を選択する。
6) ［段落スタイル］ダイアログボックスの［アウトラインと一覧］タブで、［一覧スタイル］ドロップダウン一覧で［書誌］を選択する（図25）。OK］をクリックして、書誌1の段落スタイルにこの変更を保存する。

これで、書誌を作成すると、図26のような一覧になる。また、Entriesタブの構造行を修正する必要があるかもしれない（図22）。

Updating, editing, and deleting an existing bibliography
----------------------------------------------------------------------

書誌内の任意の場所で右クリックする。コンテキストメニューから

* 目次を更新して書誌を更新する。
* 目次、索引、書誌ダイアログボックスを開き、書誌を編集・保存できる。
* 確認要求なしで書誌を削除するには、索引を削除 を選択する。

External bibliography tool
----------------------------------------------------------------------

Writerの書誌機能が制限されすぎていると感じる場合は、macOS、Windows、Linuxで利用可能な無料のオープンソースツール、Zoteroを試してみるとよいだろう。Writer（https://www.zotero.org/）との相性も良いと報告されている。
