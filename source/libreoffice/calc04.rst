======================================================================
Calc Guide Chapter 4 Formatting Data ノート
======================================================================

.. contents::
   :local:

* セルで複数行テキストを表示する方法（どれでも可）

  * :guilabel:`Format Cells` ダイアログ :guilabel:`Alignment` タブ内
    :guilabel:`Wrap text automatically` をオン
  * サイドバー :guilabel:`Wrap Text` をオン
  * ツールバー
* セルに改行文字挿入を入力する方法

  * 直接編集ならば :kbd:`Ctrl` + :kbd:`Enter` 押し
  * 数式バー編集ならば :kbd:`Shift` + :kbd:`Enter` 押し
* セルの数値書式設定

  * ツールバーのボタンで間に合うならそれを使え
  * キーバインドも設定されている (e.g. :kbd:`Ctrl` + :kbd:`Shift` + :kbd:`3`)
* フォント周りは割愛
* セル枠周りは割愛

AutoFormat
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

少なくとも三列・行（ヘッダーを含む）上で書式を設定したいセルを選択する。メニュー
:menuselection:`F&ormat --> AutoFormat &Styles...` でダイアログを開く。そこから
プリセットのスタイルを選択するか、逆に、シート上でスタイリングしてから
:guilabel:`Add` ボタンで追加するという機能だ。

値強調表示
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

値強調の表示切替は :kbd:`Ctrl` + :kbd:`F8` 押しが良い。

この表示は初期状態で有効にしたい。設定ダイアログの :menuselection:`LibreOffice
Calc --> View --> Display --> Value highlighting` をオンに設定しろ。

条件付き書式
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

事前条件は :menuselection:`&Data --> Ca&lculate --> Auto&Calculate` がオンになっ
ていることだ。

セルを選択してから :menuselection:`F&ormat > C&onditional` 以下のサブメニュー各
項目を選択するとダイアログがそれぞれ開く。

Condition
   条件を満たすセルデータを強調表示するための書式を規定する。
Color Scale
   セル値に応じて背景色を設定する。何段階かに色分けして表示する。
Data Bar
   棒グラフの棒一本一本を各セル内に描画してデータを表現する。All Cells 限定。
Icon Set
   各セルのデータの横に図像を表示し、設定範囲内のどこにデータが位置するのかを視
   覚的に表現する。All Cells 限定。
Date
   現在を基準として特定の日付範囲を指定書式で表記する。

いったん定義した条件付き書式は :menuselection:`F&ormat --> C&onditional -->
&Manage...` で編集可能。

データ表示切替
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

シートを非表示とする場合は、シートタブの右クリックメニューから
:menuselection:`&Hide Sheet` を実行する。

列または行を非表示にする場合は、列ヘッダーまたは行ヘッダーをクリックして選択状態
にし、右クリックメニューから:menuselection:`&Hide Row` または
:menuselection:`&Hide Column` を実行する。

セルを非表示にする場合、次の少し複雑な手順を要する。この手続きで、画面上では空欄
になる：

1. セルの :kbd:`Ctrl` + :kbd:`1` ダイアログ :guilabel:`Cell Protection` タブのそ
   れらしい項目をオンにする。
2. 当該セルのあるシートタブの右クリックメニューから :menuselection:`&Protect
   Sheet...` を実行し、:guilabel:`Protect this sheet and the contents of
   protected cells` をオンにする。ダイアログ上のその他の項目も適宜設定する。

非表示にしたシート、列、行を復元する方法は対応する Show コマンドを実行すればいい
のだが、先頭列を非表示から表示に戻す場合には選択にコツがいる。行 :guilabel:`1`を
選択し、列ヘッダー :guilabel:`B` の右クリックメニューから :menuselection:`Show
Columns` を実行するのだ。列の場合、縦横を入れ替えて同様の操作をすることで表示を
戻すことになる。

非表示（保護）セルの復元方法は、先ほどのダイアログ指定値を通常セルのものと同等に
すればいいだろう。パスワードに注意。
