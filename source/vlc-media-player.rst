======================================================================
VLC media player 利用ノート
======================================================================

.. |Ctrl| replace:: :kbd:`Ctrl`
.. |Enter| replace:: :kbd:`Enter`
.. |VLC| replace:: VLC media player

.. note::

   本稿執筆環境：

   :Windows: 10 Home 22H2
   :VLC media player: 3.0.20

.. contents:: 本章見出し
   :depth: 3
   :local:

概略
======================================================================

|VLC| は DVD, VCD, 様々なストリーミングプロトコル、多様な音声および映像形式
(MPEG, DivX/Xvid, Ogg, etc.) に対する高可搬性マルチメディア再生ツールだ。さまざ
まな形式の生映像やオンデマンド映像をネットワークやインターネットにストリーミング
する、強力なサーバーとしても機能する。以上が Video Lan Wiki の冒頭に述べられてい
る。

本稿の主旨は、MP4 ファイルなどの非ストリーミングメディアを快適に再生する技法を追
求することにある。

アプリケーションとプロセス
======================================================================

インストール
----------------------------------------------------------------------

公式が推奨するインストール方法は、ダウンロードページからインストーラーを入手し、
実行してインストールウィザードを実行するものだが、本稿では :program:`winget` を
用いる方法を採用したい。この実行ファイル管理ツールについては :doc:`/winget` を見
ろ。

初回インストールでは PowerShell などのコマンドライン窓から次を実行しろ：

.. sourcecode:: ps1con
   :caption: VLC media player をインストールするコマンド例

   PS> winget add -e --id VideoLAN.VLC

起動と終了
----------------------------------------------------------------------

初回は Windows タスクバーの検索欄からキーボードで ``vlc`` と打ち込んで
:guilabel:`アプリ` 区画にある項目をクリックすれば |VLC| が起動する。いったん起動
したらタスクバーにピン留めするといい。

Windows Explorer でメディアファイル項目をダブルクリックや |Enter| で |VLC| を開
くように関連付けを指定することも可能だ。その手順は環境設定の節で記す。

実行中の |VLC| の終了方法は一般的な Windows アプリケーションと同様だ。次のいずれ
でもかまわない：

* メインウィンドウ右上のバツボタンをクリックする
* キーバインド |Ctrl| + :kbd:`Q`
* メニューバーから :menuselection:`&Media-->&Quit` を選択する
* タスクバーのタスク右クリックメニューから :menuselection:`ウィンドウを閉じる`
  を選択する
* タスクトレイのアイコン右クリックメニューから :menuselection:`Quit` を選択する

アンインストール
----------------------------------------------------------------------

公式推奨方法は Windows 標準の :menuselection:`アプリと機能` から |VLC| を選択、
アンインストールするものだ。何かの作業で :program:`winget` を利用する機会があれ
ば、そのついでにアンインストールするのもよい。

.. sourcecode:: ps1con
   :caption: VLC media player をアンインストールするコマンド例

   PS> winget rm -e --id VideoLAN.VLC --purge

環境構成
======================================================================

次の手順のどちらかで設定ダイアログボックスが開く：

* メニューバーから :menuselection:`Tool&s-->&Preferences` を選択
* キーバインド |Ctrl| + :kbd:`P`

ダイアログボックスのタイトルバーには :guilabel:`Show settings` モードによって
:guilabel:`Simple Preferences` か :guilabel:`Advanced Preferences` と記載されて
いる。|VLC| の動作を調整するには、このダイアログボックスにある項目を操作する。

初期化方法
----------------------------------------------------------------------

インストール直後の状態に環境を戻すには、ダイアログボックス左下付近にある
:guilabel:`&Reset Preferences` ボタンを押し、確認メッセージボックスで
:guilabel:`OK` を押す。

設定ファイル
----------------------------------------------------------------------

このようにして行ったアプリケーション設定はテキストファイル
:file:`%APPDATA%/vlc/vlcrc` に保存されている。ヘビーユーザーはこの五千行以上ある
ファイルをバージョン管理すると考えられる。

GUI
======================================================================

Windows 版 |VLC| は Qt で実装されているとのことで、十分柔軟なインターフェイスが
備わっている。

主要インターフェイス
----------------------------------------------------------------------

|VLC| メインウィンドウを解剖するとだいだいこうなる：

メニューバー
   たいていの Windows アプリケーションにある GUI なので、|VLC| にもある。
トラックスライダー
   ビデオファイルが再生すると、映像再生エリアの下にあるこれが使用可能になる。
   YouTube でいうシークバーに相当する。スライダーを左や右にドラッグすると再生位
   置を操作できる。ストリーミングで再生する場合、トラックスライダーは動かない。
コントロールボタン
   トラックスライダーの下にあるボタン群は基本的な再生機能をすべて対処する。
音量コントロール
   コントロールボタン群のはるか右に位置する。見れば使い方はわかる。
再生一覧
   これは後述。Floating と Docking のどちらかの状態をとる。
ステータスバー
   これもたいていの Windows アプリケーションにある GUI だ。テキストが選択可能で
   あるのがささやかながらも有益だ。

メニューバー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   この節の構成をどうするか？

トラックスライダー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

メインスライダー
   再生対象メディアのタイムラインを操作する。

   タイムラインのどこかをクリックすると、その位置まで映像・音声がスキップする。
   タイムラインのスライダーをドラッグすると、映像・音声上の位置に追従する。

   マウスカーソルがスライダー上にホバーすると、クリックしたときの位置がツール
   チップに表示される。
サウンドスライダー
   この三角形の UI では音量を操作することが可能だ。

   サウンドスライダーのどこかをクリックすると音量が変化する。スライダーをクリッ
   ク＆ドラッグすると音量も変化する。スライダーの外側でクリックを離すと以前の音
   量値に再設定する。

   マウスカーソルをホバーすると、クリックしたときの音量がツールチップに表示され
   る。

   三角形の左側のスピーカー図像をクリックすると消音モードオンオフ切り替え。
サウンド範囲
   音量は 0% から 125% までの係数で制御する。

   100% は増幅なしの通常のファイル出力を意味する。100% 以上はソフトウェア増幅を
   使用する可能性があり、音が歪むことがあることを意味する（通常は歪まないが、そ
   の可能性はある）。

.. admonition:: 利用者ノート

   メインスライダー右側の時刻表示をクリックすると、(1) 絶対時刻と (2) 終了時刻か
   らの相対時刻、言い換えれば残り再生時間に表記が切り替わる。FFmpeg などを使って
   メディアファイルから終端付近を切り落とす際の引数を得るのに (2) がなかなか便利
   だ。

再生コントロール
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TBW

再生一覧
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows Explorer のように図像表示、詳細表示、一覧表示がある。これらのビューを再
生一覧上部にある :guilabel:`Change Playlistview` 図像をクリックして循環変更する
ことが可能だ。直接変更するには次のいずれかを行う：

* メニューバーから :menuselection:`V&iew-->Playlist Viewmode-->Detailed List` な
  どを選択
* 右クリックメニューから :menuselection:`Playlist View Mode-->Detailed List` な
  どを選択

再生一覧の消去や並べ替えは、表示窓の背景を右クリックすることで行える。また、この
メニューから表示寸法を変更することもできる。

.. admonition:: 利用者ノート

   どの表示モードも一長一短ある。画像ビューワーでは図像表示が好みだとしても
   |VLC| でもそうなるとは限らない。サムネイルの縦横が歪んで気になる。

   詳細表示モードでは採用するテーブル列をある程度指定可能であることに気をつけ
   ろ。特に YouTube ビデオを並べるときは Artist や Description も出しておくとい
   い。なぜか Date 項目の値が存在しないのが残念だ。

ステータスバー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|VLC| のステータスバーは三区画に分割されている。

第一区画は名前ラベルと呼ばれていて、現在再生中のメディアのタイトルが表示されるも
のと思われる。ここではマウスを読み取り専用テキストボックスであるかのように操作す
ることが可能だ。例えばテキスト選択、それをクリップボードにコピーすることも可能
だ。

第二区画は再生速度を示す区画だろう。通常は ``1.00x`` のように表示されている。マ
ウスでクリックすると細かい速度調整を表示するコントロールが表示される。操作方法は
見ればわかる。ダブルクリックで再生速度を標準に戻せる。

第三区画は再生時刻を示す区画だ。先述のサウンドスライダーの右端の時刻表示と同期し
ている。クリックで同様に時刻表記を切り替える。ダブルクリックで :guilabel:`Go to
Time` ダイアログボックスが開く（多分後述する）。|VLC| が総時間を把握しない手段で
再生している場合は経過時間しか表示せず、尺の代わりに ``--:--`` を表示する。

タスクトレイアイコン
----------------------------------------------------------------------

|VLC| のタスクトレイアイコンをクリックすると、ウィンドウやタスクバーボタンの表示
状態が切り替わる。隠してもアプリケーションが終了するわけではない。バックグラウン
ドで実行中のままだ。タスクトレイアイコンを右クリックすると基本的操作を含むメ
ニューが表示される。

資料
======================================================================

* `VLC Home page <https://www.videolan.org/vlc/>`__
* `VLC media player - VideoLAN Wiki <https://wiki.videolan.org/VLC_media_player/>`__

..
  メディア再生手順
     単一メディアファイルを再生する
     メディアフォルダーを丸ごと再生する
     CD/DVD/VCD を再生する
     And more
        ネットワークストリームを再生する
        キャプチャー？
  再生一覧
     概念
     一覧操作（追加、削除、並び替え、等々）
     ロードとセーブ
     モード
     その他
        検索
        移動
        メニュー
        例
  VLC CLI
