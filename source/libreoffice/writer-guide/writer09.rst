======================================================================
Writer Guide Chapter 9, Working with Styles ノート
======================================================================

.. contents::
   :depth: 3
   :local:

Introduction
======================================================================

第8章 スタイル入門では、スタイルの使用、適用、管理方法の基本について説明している。 この章では、スタイルダイアログ欄のさまざまなタブで利用できる多くのオプションを使用して、いくつかのスタイルを作成または変更する方法について、より詳しく説明する。これらのオプションがスタイルの外観にどのような影響を与えるか、またそれらを効率的に使用する方法について説明する。

スタイルダイアログ欄は手動書式設定ダイアログ欄と同じタブを多く共有しているので、この章は手動書式設定の適用にも役立つ（ただし、スタイルを使用する場合はその必要はない）。

Creating custom (new) styles
======================================================================

LibreOffice が提供する定義済みのスタイルを使用するだけでなく、新しいカスタム (ユーザー定義) スタイルを追加することもできる。第 8 章では、新しいスタイルを作成する方法として、ドラッグアンドドロップ、スタイルデッキの「選択範囲から新規スタイル」図像、スタイルダイアログ欄の 3 つを紹介する。

これらの方法のうち最初の二つは、スタイルを作成する前にスタイルが生み出す視覚効果を確認できるので便利だ。しかし、スタイル（および他のスタイルとの関係）を完全に制御するには、この章で説明するスタイルダイアログ欄を使用する必要がある。

.. note::

   テーブル・スタイルは別の方法で作成する。

Style dialog
----------------------------------------------------------------------

サイドバーのスタイルデッキを開く。スタイルデッキの上部にある適切な図像をクリックして、作成したいスタイルのカテゴリーを選択する。

ウィンドウ内で右クリックし、コンテキストメニューから新規作成を選択する。表示されるダイアログ欄は選択したスタイルの種類によって異なる。

.. tip::

   新しいスタイルの作成と既存のスタイルの変更に使用されるダイアログ欄はほとんど同じだが、一つだけ例外がある。248ページの「条件付き段落スタイルの使用」を参照しろ。

Organizer tab
----------------------------------------------------------------------

図215に示す「オーガナイザー」タブは、すべてのスタイル・カテゴリー（テーブル・スタイルを除く）に共通で、カテゴリー間の違いはわずかである。したがって、このタブについては 1 回しか説明しない。

作成するスタイルに応じて、このタブには以下のフィールドがある。

名前： すべてのカテゴリーにある。このフィールドを使用して、作成するスタイルに名前を付けます。
自動更新：段落スタイルとフレームスタイルにのみ適用される。このオプションが選択されている場合、そのスタイルでフォーマットされた段落やフレームに手動で変更を加えると、Writerはそのスタイル自体に適用する。

.. caution::

   文書のスタイルを手動で上書きする習慣がある場合は、AutoUpdateが有効になっていないことを確認しろ。

Next Style
   段落スタイルとページスタイルでのみ使用可能だ。同じタイプの次の要素に適用されるスタイルを指定するために使用する。例えば、左ページスタイルの後には通常右ページスタイルが続き、最初のページスタイルの後には左ページスタイルが続き、見出しの後にはテキスト本文が続くといった具合だ。
Inherit from
   段落スタイル、文字スタイル、フレームスタイルで使用可能で、階層におけるスタイルの位置を決定する。新しいスタイルのすべての開始プロパティは、ここで指定されたスタイルから継承（コピー）される。
Category
   これを使用して、新しいスタイルをカテゴリのいずれかに関連付けます。定義済みのスタイルのカテゴリを変更することはできない。このフィールドを設定すると、スタイル・デッキの内容をフィルタリングするときに便利だ。
Contains
   には、スタイルのプロパティの概要が表示される。

Style inheritance
----------------------------------------------------------------------

新しい段落スタイルまたは新しい文字スタイルを作成する場合、既存のスタイルを設定の開始点として使用できる。この意味で、LibreOffice はスタイルをリンクしている。

スタイル設定が継承される場合、親スタイルの変更は、そこから継承されるすべてのスタイルに影響する。スタイル間のつながりを確認するには、スタイル デッキ フィルタの階層ビューに切り替えます。たとえば、すべての見出しスタイル（見出し 1、見出し 2 など）は、見出しというスタイルから継承される。この関係を図 216 に示する。

継承は、同時にプロパティを変更できるスタイルの「ファミリー」を作成する方法だ。例えば、（このガイドのように）すべての見出しを緑色にすると決めた場合、親スタイルのフォントカラーを変更するだけで望ましい結果を得ることができる。 ただし、親スタイルのパラメータに加えた変更は、子スタイルの同じパラメータに以前に加えた変更を上書きしない。例えば、見出し2のフォントカラーを緑に変更した場合、見出しスタイル（親スタイル）のフォントカラーを赤に変更しても、見出し2のフォントカラーには影響しない。

どのプロパティがスタイルに固有であるかは、[Organizer] タブの [Contains] セクションを見れば簡単に確認できる。子スタイルのプロパティを親スタイルのプロパティにリセットしたい場合は、各段落および文字スタイルダイアログ欄の下部にある［親スタイルにリセット］ボタンをクリックする。

Example: Changing a property of a parent style
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

見出し1や見出し2だけでなく、すべての見出しのフォントを変更したいとする。

#. スタイルデッキを開き、段落スタイルカテゴリを選択し、見出しを右クリックし、スタイルの編集を選択し、見出しスタイルの段落スタイルダイアログ欄を開く。
#. フォント」タブを選択し、フォントを選択して「OK」をクリックする。これで、すべての見出しスタイル（見出し1～見出し10）のフォントが一度の操作で変更される。

Working with paragraph styles
======================================================================

このセクションでは、図217に示すタブページに散在するパラメータのほとんどについて説明するが、これらすべてを設定する必要はない。ほとんどの場合、特にスタイルをリンクしたり、新しいスタイルを類似のスタイルに基づかせたりする場合は、いくつかの属性のみを変更する必要がある。

Indents & Spacing tab
----------------------------------------------------------------------

インデントとスペーシング」タブ（図218）では、段落のインデント、行間、段落と上下の段落のスペーシングを設定できる。

タブの「インデント」セクションを使用して、これらのパラメータを使用してインデントを設定する：

Before text
   は、ページの左マージンと段落領域の左端との間のスペースを制御する。負の値を入力すると、テキストはマージンの左から始まります。これは、左マージンがかなり広いが、見出しをページの中央に配置したい場合に便利だ。
After text
   は、ページの右マージンと段落領域の右端との間のスペースを制御する。負の値を入力すると、テキストがページの右マージンにはみ出する。
First line
   この欄には、段落領域に対する段落の最初の行のオフセット（正または負）を入力する。正の値を入力すると、最初の行のインデントが大きくなり、負の値を入力すると、最初の行の開始位置が段落領域の左側になる。
Automatic
   この欄を選択すると、Writerが自動的に最初の行のインデントを制御する。この値は、フォントサイズとその他のパラメータに基づいてWriterが計算する。

タブの「スペーシング」セクションを使って、段落の上下のスペースを決めます。見出しスタイルでは、空の段落を挿入しなくても前のセクションのテキスト本文と分離できるように、「上にスペース」を入れるのが通例だ。ある種の文書では段落間にスペースを入れるのも普通だ。このガイドの本文スタイルは、連続する段落の間にスペースを残すように設定されている。 同じスタイルの段落間のスペースを削除するオプションを選択できる。

.. note::

   ツール] > [オプション] > [LibreOffice Writer] > [互換性] のオプションは、上のスペースと下のスペースを一緒に追加するか (既定)、または大きい方のスペースだけを適用するかを制御する。詳細については、第 20 章「Writer のカスタマイズ」を参照しろ。

段落間の間隔は、段落内の行間には影響しない。以下の値のいずれかを選択できる：

シングル：既定設定。段落にシングルの行間を適用する。行間はフォントサイズに基づいて自動的に計算される。
1.15行：行間を1.15行に設定する。
1.15行：行間を1.15行に設定する。
1.5行：行間を1.5行に設定する。
- 2倍：行間を2行に設定する。
- 比例：エディット欄をアクティブにする。100%は1行間隔、200%は2行間隔といった具合だ。行間に使用する最小値（選択した単位）を入力する。連続する 2 行のテキストのベースライン間の垂直スペー スの高さを制御するには、値を入力する。行間隔の正確な値を入力する。
最低：エディット欄をアクティブにする。行間に使用する最小値（選択した測定単位）を入力する。
連続する 2 行のテキストのベースライン間の垂直スペースの高さを制御するには、
値を入力する。行間隔の正確な値を入力する。

.. tip::

   同じ段落で異なるフォントサイズを使用すると、行間が不揃いになることがある。行間を均等にするには、ドロップダウン一覧で「固定」または「少なくとも」を選択し、使用する最大のフォントサイズを考慮した十分な行間を作成するのに十分な大きさの値を指定する。

このタブの最後のオプションは「ページ行間を有効にする」だ。これは、ページスタイルにページ行間を使用するオプション（254ページ参照）と連動する。これらのオプションの使い方については、ヘルプおよび第6章「ページの書式設定：詳細」を参照しろ。

Alignment tab
----------------------------------------------------------------------

左揃え、右揃え、中央揃え、ジャスティファイドの中から選択する。選択結果は、タブの右側にあるプレビューウィンドウに表示される。

両端揃えを選択すると、段落の最終行をどのように扱うかを設定できる。既定では、Writerは最終行を左（開始）に揃えますが、中央揃えにするか、両端揃えにするかを選択できる（つまり、最終行の単語は、その行を完全に占めるように間隔が空けられる）。最終行を両端揃えにし、「単一単語を展開」オプションを選択した場合、両端揃えの段落の最終行が単一単語で構成されている場合、この単語は文字間にスペースを挿入して引き伸ばされ、行の全長を占めるようになる。

同じ行に複数のフォントサイズがある場合に便利だ。行のフォントのうち、「自動」、「基準線」、「上」、「中」、「下」の間で揃える要素を選択する。これらの参照点の視覚的な表現については、図 219 を参照しろ。

Text flow options for paragraph styles
----------------------------------------------------------------------

テキストフロー」タブ（図220）には、「ハイフネーション」、「改行」、「オプション」の三つのパートがある。

Hyphenation options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ハイフネーション]で[自動的に]が選択されている場合、これらのオプションが使用できる：

Don't hyphenate words in CAPS
   すべて大文字で書かれた単語にハイフンを挿入しないこと。
Don't hyphenate the last word
   段落の最後の単語にハイフンを挿入しない。
Characters at line end
   行末に残す最小文字数を制御する。
Characters at line begin
   ハイフンに続く行頭の最小文字数を制御する。
Maximum consecutive hyphenated lines
   ハイフネーションできる連続した行の最大数を制御する。組版上の標準は2である。
Minimum word length in characters
   ハイフンを使用できる最小の単語長を文字数で指定する。
Hyphenation zone
   単語をハイフネーションできない水平スペースの長さを指定する。ハイフネーション・ゾーンを指定すると、ジャスティファイド・テキストでは単語間のスペースが大きくなり、非ジャスティファイド・テキストでは段落マージンからの距離が大きくなる。

Breaks options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Break（改行）セクションでは、段落を新しいページまたは段落から開始させ、改行の位置、新しいページのスタイル、ページ番号を指定することができる。このオプションの典型的な使い方は、新しい章の最初のページを新しい（通常は右側の）ページから始めることだ。

新しいページを常に特定のスタイルで開始するには、以下の設定を選択する：

区切り］セクションで［挿入］を選択する。タイプ］が［ページ］に、［位置］が［前］に設定されていることを確認する。
- ［ページスタイル付き］を選択し、一覧からページスタイルを選択する。
各章のページ番号を「1」（一部の技術文書で使用されるスタイル）で再開するには、「ページ番号」を選択し、「1」に設定する。

.. note::

   新しい章の最初のページを常に右ページで開始したい場合は、ページスタイルダイアログ欄のページタブのレイアウト設定フィールドでこの選択を行って、最初の章ページのページスタイルが右ページのみに設定されていることを確認しろ（253ページの図231参照）。

Other options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

テキストフロー」タブの「オプション」セクションには、段落がページの下に収まらない場合にどうするかを制御する設定がある：

* 段落を分割しない：段落が一ページの下に収まらない場合、段落全体が次のページの上に移動する。この場合、ページの下部に大きな空白が生じる可能性がある。
* 次の段落に続ける：ページの最後の段落にならないように、見出しや一覧のリード文に使用する。
* オーファン・コントロールとウィドウ・コントロール：ウィドウとオーファンは組版用語である。孤児とは、段落の最初の行が単独でページや段の一番下にあること。ウィドウとは、次のページまたは段の一番上に単独で表示される段落の最終行のことだ。これらのオプションを使って、段落がページや列をまたいで分割できるようにするが、ページや列の一番下または一番上に少なくとも2行以上一緒に残るようにする。何行を一緒に残すかを指定できる。

Font options for the paragraph style
----------------------------------------------------------------------

段落スタイルダイアログ欄の三つのタブは、書体の外観を制御する設定専用だ。最初の二つのタブは簡単で、オプションの多くは250ページで説明した文字スタイルの作成時に使用するものと同じだ。段落スタイルを作成するときに使用できるオプションについては、ここで説明する。

.. tip::

   フォント」タブの右下には「機能」ボタンがある。開いたダイアログ欄で設定可能な機能は、選択したフォントによって異なるため、ここでは説明しない。例えば、任意の合字や水平カーニングなどがある。

Specifying a relative font size
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

固定のフォント サイズ（ポイントまたはその他の測定単位）を指定できる。さらに、他のスタイル（リンクされたスタイル）に基づいてスタイルを作成する場合は、他のスタイルとの相対的なフォント サイズをパーセンテージまたはプラスまたはマイナスのポイント値（-2pt または +5pt）で指定できる。相対フォントサイズはウェブページでよく使われる。

例えば、見出し1段落スタイルは見出しスタイルに基づいている。見出しスタイルのフォント・サイズが14ptで、見出し1スタイルのフォント・サイズが130%と指定された場合、見出し1スタイルでフォーマットされた段落のテキストのフォント・サイズは14pt x 130% = 18.2ptとなる。

パーセンテージのフォントサイズを指定するには：［段落スタイル］ダイアログ欄で［フォント］タブを選択する。サイズ」欄で、パーセント値を入力し、その後に記号 % を続けます（図 221）。同様に、プラス記号またはマイナス記号の後に、基本フォントサイズに加算または減算するポイント数を入力することもできる。

相対フォントサイズから絶対フォントサイズに戻すには、希望するフォントサイズをポイント（pt）のような具体的な単位で入力する。

Selecting a language for a paragraph style
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

文書に選択されている言語（「ツール」→「オプション」→「言語設定」→「言語」）によって、スペル、シソーラス、ハイフネーション、使用される小数点および千単位区切り記号、既定の通貨形式に使用される辞書が決まります。辞書がインストールされている言語しか使用できない。

文書内では、任意の段落スタイルに個別の言語を適用できる。この設定は文書全体の言語よりも優先される。

段落スタイル］ダイアログ欄の［フォント］タブでは、辞書がインストールされている言語が［言語］一覧に小さな図像で表示される（図222）。スペルチェックの際、Writerはこのスタイルの段落に正しい辞書を使用する。

複数の言語で文書を書く場合、リンクされたスタイルを使って、言語オプションだけが異なる二つの段落スタイルを作成することができる。その後、段落スタイルの他のプロパティのいくつかを変更したい場合、必要なのは親スタイルを変更することだけだ。

スペル・チェッカーで間違って選ばれるのを避けるために、時折異なる言語の単語を挿入するには、250ページの「新しい文字スタイルの作成」で説明するように、文字スタイルを使用する方が便利だ。

.. tip::

   言語]に[なし]を選択すると、URLやプログラミングコードなど、チェックしたくないテキストが段落に含まれている場合に便利だ。

Options for positioning text
----------------------------------------------------------------------

段落スタイルダイアログ欄の「位置」タブには、画面や印刷ページのテキストの位置に影響するすべてのオプションが集められている。

位置] セクションを使用して、上付き文字と下付き文字 (H2O や M2 のように、通常の活字行の上または下にある文字) の外観を制御する。しかし、通常、上付き文字や下付き文字は段落全体に適用するのではなく、文字のグループに適用する。したがって、これらのパラメータは文字スタイルを定義するときにのみ変更し、段落スタイルについては既定設定のままにすることを強くお勧めする。

位置」タブの2番目のセクションは、段落領域の回転を制御する。段落を回転させる一般的な使い方のひとつは、狭い表の列の上に見出しを合わせることです（図224）。もうひとつの用途は、横長のページに縦長のヘッダーとフッターを作成することです：詳しくは第 6 章「ページの書式設定：詳細」を参照しろ。

Scale width 欄は、回転したテキストを水平方向に圧縮または伸張するフォント幅のパーセンテージを制御する。

.. tip::

   回転させた表の見出しは通常、垂直ではなく角度をつけた方が読みやすくなる。角度のついたテキストを作成するには、描画ツールバーからテキストオブジェクトを作成し、任意の角度に回転させる必要がある。第11章画像と画像を参照しろ。

Example: Rotating the text in a paragraph style
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

例として、既存の表に回転した表の見出しを適用する。

#. 新しい段落スタイルを作成する。
#. ［段落スタイル］ダイアログ欄の［位置］タブで、［回転/拡大縮小］セクションで［90度］を選択する。
#. 表の見出し行を選択し、新しいスタイルを適用する。
#. 見出しがセルの一番上に配置されている場合、図224に示すように、セルの一番下に配置を変更することができる。これを行うには、表ツールバーの「下」図像をクリックするか、メニューの「書式」→「整列」→「下」を選択する。

Spacing options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

段落内の個々の文字の間隔を制御するには、［位置］タブの［間隔］セクションを使用する。ドロップダウンメニューで既定以外のオプションを選択した場合は、エディット欄を使用して、テキストを拡大または縮小する値をポイント単位で入力する。

ペアカーニングオプション (既定で選択) は、特定の文字のペア間のスペースを増減して、テキスト全体の外観を改善する (図 225)。 カーニングは、特定の文字の組み合わせに対して文字間隔を自動的に調整する。カーニングは特定のフォントタイプでのみ利用でき、印刷文書ではプリンターがサポートしている場合にのみ機能する。

Controlling tab stops
----------------------------------------------------------------------

ボーダーレス・テーブルは、一般的に、ページ全体に素材を配置するためのより良いソリューションと考えられているが、管理しやすく、適用が早いという利点もあり、必要なことを行うにはタブで十分な状況もある。

.. caution::

   タブを使用する必要があり、文書を他の人に送信する場合は、既定のタブストップを使用するな。文書の受信者が既定のタブストップを定義しており、そのタブストップがあなたの使用しているタブストップと異なる場合、受信者のマシンでは段落の見た目が大きく異なる可能性がある。代わりに、段落または段落スタイルでタブストップを明確に定義しろ。

段落スタイルでタブストップを定義するには、図226に示す「タブ」ページを使用する。ここでは、タブのタイプを選択できる：タブのタイプ：左、右、中央、小数、小数点として使用する文字、および塗りつぶし文字（タブの前のテキストの終わりとタブの後のテキストの始まりの間に表示される文字）を選択できる。

また、対応する欄に入力して、カスタム塗りつぶし文字を作成することもできる。塗りつぶし文字の一般的な使用例としては、目次の見出しとページ番号の間にドットを追加したり、記入用のフォームを作成する際にアンダースコア文字を追加したりすることが挙げられる。

新しいタブストップを作成するには、左マージンからの相対位置、タブのタイプ、塗りつぶし文字を指定し、「新規」ボタンをクリックする。タブストップの位置を変更するには、ページの右側にあるボタンを使用して、希望の位置に新しいタブストップを作成し、古いタブストップを削除する。

ページマージンを超えるタブを定義することはできない。まれに必要な場合は、代わりにボーダーレス・テーブルを使用しろ。

Outline & List tab
----------------------------------------------------------------------

第8章「スタイル入門」で説明したように、「アウトラインと一覧」タブを使用して、任意の段落スタイルにアウトラインレベルを割り当てます。この機能により、「ツール > 見出し番号付け」に一覧されているスタイルを使用して、見出しとともにそれらの段落を含む目次を作成することができる。

このタブを使用して、段落スタイルを一覧スタイルに関連付けることもできる。詳細と例については、第12章一覧を参照しろ。

Setting up a drop cap
----------------------------------------------------------------------

ドロップキャップ（段落の先頭に一つ以上の文字を大きめのフォントで表示）は、一般に最初の段落スタイルにのみ適している。段落スタイル］ダイアログ欄の［ドロップキャップ］タブでプロパティを事前定義できる。ドロップキャップの表示］オプションを選択すると、他の選択肢も有効になる：占有行数、拡大する文字数（最初の単語全体が必要な場合は、対応する欄にチェックを入れる）、ドロップキャップとテキストの間のスペース。

ドロップキャップは、段落の他の部分と同じフォントと同じプロパティを使用するが、特定の文字スタイルを作成して使用することで、簡単に外観を変更することができる。たとえば、ドロップキャップの色を変えたり、アウトライン効果を適用したりすることができる。 対応するドロップダウンメニューで、使用する文字スタイルを選択する。

Background (area), highlighting, and transparency
----------------------------------------------------------------------

段落に背景色、グラデーション、パターン、ハッチング、または画像を追加することは、フレームを使用する代わりに使用できる。段落スタイルダイアログ欄のエリアタブで背景をカスタマイズできる。選択肢については、第6章「ページの書式設定」で説明している：上級者向け」で説明している。

エリア」タブを操作する際には、以下の点を考慮するとよいだろう：

* あらかじめ定義されている色の一覧に希望の色がない場合は、第20章「ライターのカスタマイズ」で説明されているように、自分で色を定義することができる。
* 段落領域と段落内のテキストに異なる背景を選択できる。テキストには「ハイライト」タブを使用する。図 229 はその違いを示している。
* 領域処理は段落領域にのみ適用される。インデントされた段落を定義した場合、段落とマージンの間のスペースは段落の背景色を持ちません。

透明度タブでは、選択した背景の透明度オプションを選択できる。 値の範囲は0%（完全に不透明）から+100%（完全に透明）だ。

Borders
----------------------------------------------------------------------

ボーダーは、フレームを使わずに段落をテキストから切り離したり、（このガイドのように）ヘッダーやフッターの領域をメインのテキスト領域から切り離したり、見出しスタイルによっては装飾的な要素を提供するためによく使われる。以下の点を考慮しろ：

* ボーダーと段落の間隔がインデントやタブに与える影響に注意しろ。
* 複数の段落を囲むように枠線を引きたい場合は、ページ下部の「次の段落に統合」オプションを選択したままにしておきます。
* 多くの場合、余白は同じ効果をもたらす。

See Chapter 4, Formatting Text, for more about the Borders tab.

Using conditional paragraph styles
----------------------------------------------------------------------

段落スタイルを条件付きにするということは、それが使われる場所によって書式が変わるということだ。例えば、MyTextBodyのスタイルを既定では黒にし、背景が青のフレーム内では白にすることができる。

条件付き書式の最も一般的な使い方は、おそらくシングルスタイルのアウトラインだ。シングルスタイルのアウトラインは、ナンバリング一覧スタイルでデザインされたアウトラインナンバリングの一種だ。様々なアウトラインレベルに対して異なるスタイルを使用する代わりに、Tabキーを押して従属見出しを作成するときに番号の書式を変更する。

単一スタイルのアウトラインの唯一の問題は、すべてのレベルが同じように見えることである。そこで便利なのが、条件付きの段落スタイルだ。アウトラインと一覧］タブで段落スタイルをアウトラインスタイルに割り当て、［条件］タブを開く。そこで、アウトラインスタイルのレベルを他の段落スタイルに割り当てることができる。そして、段落スタイルを使用中にTabキーを押すと、アウトラインの各レベルに異なる書式が適用され、シングルスタイルのアウトラインが単独よりもさらに便利になる。

条件付きスタイルを作成すると、「この条件では、このスタイルを他のスタイルのようにする」ということになる。たとえば、「フッターに入力するときは、このスタイルをmy_footer段落スタイルのようにし、表に入力するときは、このスタイルをtable_text段落スタイルのようにする」とする。

スタイルの通常の（無条件の）プロパティを設定するだけでなく、さまざまな状況で他のスタイルをどのように見せるかを定義する必要がある。これを行うには、［条件］タブを使用する。

.. note::

   既定」、「見出し1」、「見出し2」などの定義済みスタイル（本文以外）は、条件付きに設定できない。

.. caution::

   新しいスタイルを作成して条件付きにする場合は、「段落スタイル」ダイアログ欄を初めて開いた状態で行う必要がある。ダイアログ欄が閉じた後、再びダイアログ欄を開いても条件タブは表示されない。

条件付き段落スタイルを設定するには：

#. 新しい段落スタイルを定義する。
#. スタイルの段落プロパティをすべて選択する。
#. 「条件」タブをクリックする。
#. 「コンテキスト」一覧（ダイアログ欄の左側）で最初の条件を選択し、右側の「段落スタイル」一覧でこの条件に必要なスタイルを選択する。段落スタイルの名前が中央の一覧に表示される。
#. 適用をクリックする。段落スタイルの名前が中央の一覧に表示される。
#. 別のスタイルにリンクさせたい各条件について、手順 4) と 5) を繰り返する。
#. OK

スタイルが選択されると、テキストの書式設定がコンテキストに依存することがわかります。

Working with character styles
======================================================================

文字スタイルは段落スタイルの書式を上書きする。段落全体ではなく、単語やフレーズなどの文字のグループに適用される。他の部分に影響を与えずに、段落の一部の外観や属性を変更したい場合に主に使われる。文字スタイルによって得られる効果の例としては、太字や斜体の書体、色のついた単語などがある。

文字スタイルのその他の使い方については、本書の他の箇所で説明している。これらの使い方には、章番号、ページ番号、一覧番号を周囲のテキストよりも大きくしたり、ハイパーリンクの書式を設定したりすることが含まれる。一部の単語（例えば、名前や異なる言語の単語）をスペルミスとして検出させたくない場合、文字スタイルのプロパティで適用する言語（もしあれば）を定義することができる。

Creating a new character style
----------------------------------------------------------------------

文字スタイルダイアログ欄のタブは段落スタイルのタブと似ている：

* オーガナイザ（Organizer）タブを使用して、新しいキャラクタ スタイルに名前を付け、階層レベルを設定する（必要な場合）。
* フォント] タブを使用して、新しい文字スタイルのフォント、スタイル、およびサイズを選択する。フォント サイズは、文字スタイルが適用される段落のフォント サイズのパーセントまたはポイントの増減として指定できる。また、文字スタイルが適用されるテキストの言語を指定できるので、異なる言語の単語を挿入して、正しい辞書を使用してスペルをチェックすることができる。
* フォントの色、下線、浮き彫り、その他の効果などの属性を設定するには、「フォント効果」タブを使用する。例えば、非表示のテキストを頻繁に使用する場合、非表示オプションがマークされた文字スタイルを定義すると便利だ。レリーフ効果は、ドロップキャップや、章番号や表題の他の部分をより強調するのに適しているかもしれない。
* テキストに色の付いた背景を適用するには、「ハイライト」タブを使用する。これは、標準ツールバーのハイライトカラーツールを使用するのと同じ効果が得られる。
* テキストにボーダーとシャドウを適用するには、「ボーダー」タブを使用する。
* 既定の添え字や上付き文字に満足できない場合は、「位置」タブを使って下付き文字や上付き文字を作成する。同じタブで、回転、凝縮、拡大テキストを作成できる。

.. note::

   文字グループを回転させる場合、回転させたテキストを行内に収めるか、行の上下に展開させるかを指定する必要もある。このプロパティは文字スタイルに対してのみ有効だ。

Working with frame styles
======================================================================

フレームはしばしばテキストや画像のコンテナとして使われる。同じような目的で使われるフレームの見た目に一貫性を持たせるために、フレームのスタイルを定義しておくとよいだろう。例えば、写真はドロップシャドーの枠線で囲み、線画は無地の枠線で囲み、余白は枠線なしで背景に影をつけた枠線で囲むなどだ。

Writerには定義済みのフレームスタイルがいくつか用意されており（表7）、必要に応じて変更したり、新しいフレームスタイルを定義したりすることができる。フレームスタイルの定義と適用方法は、他のスタイルと同様だ。

.. tip::

   ページレイアウトの目的によっては、フレームとセクションの使い方はかなり重複している。第6章「ページの書式設定」を参照しろ：フレームとセクションの使い方については、第6章「ページの書式設定：詳細」を参照しろ。

How frame styles work
----------------------------------------------------------------------

オブジェクトがWriterに追加されると、あらかじめ決められたタイプのフレームで自動的に囲まれる。このフレームによって、オブジェクトがページ上にどのように配置されるか、また文書内の他の要素とどのように相互作用するかが設定される。フレームを編集するには、使用するフレームスタイルを変更するか、文書にフレームが追加されたときに手動で上書きする。

フレームとオブジェクトは一緒に使われるため、時には別々の要素であることを忘れがちだ。チャートのように、フレームとオブジェクトを別々に編集できる場合もある。

.. note::

   スタイルを使用する他の要素とは異なり、フレームは、その使用が非常に多様であるため、そのスタイルによって部分的にしか定義できない。アンカーやprotected要素など、フレームのいくつかの要素は、個々のフレームに対して手動で定義する必要がある。

   フレームを手動でフォーマットするには、メニューの「挿入」＞「フレーム」を選択する。開いたダイアログ欄には、フレームスタイルが設定されたときに利用できるすべての設定と、フレームが挿入されたときにのみ利用できる設定が含まれている。詳しくは第6章「ページの書式設定」をご覧ください：詳細については、第6章「ページの書式設定：詳細設定」を参照しろ。

Planning the styles
----------------------------------------------------------------------

画像スを混在させて使用する場合は、関連する二つのスタイルを定義するとよいだろう。一つは背景が白の画像ス用のボーダー付きスタイル、もう一つはそれ以外の背景用のボーダーなしスタイルだ。また、テキストだけのフレームを一つ以上デザインすることもできる。

そうでなければ、既定のフレームスタイル（表7に一覧アップ）でほとんどのユーザーのニーズをカバーできる。唯一必要と思われるのは、テキスト・フレーム用の一つ以上のスタイルだ。

Creating or modifying frame styles
----------------------------------------------------------------------

フレームスタイルの設定にアクセスするには、スタイルデッキのフレームスタイルを右クリックし、コンテキストメニューから「新規作成」または「スタイルの編集」を選択する。

* Typeタブ：フレームのサイズと位置を設定する。ここで最も便利なオプションの一つはAutoSizeで、これはフレームを含むオブジェクトに自動的に合わせる。フレームスタイルが自動的に使用される場合は、このオプションを選択する必要がある。
* Optionsタブ：フレームの内容を印刷するか、読み取り専用文書で編集可能にするか、装飾だけにするかを設定する。このタブではテキストの方向も設定する。右から左へのテキスト方向を使用する言語の中身にフレームを使用する場合に便利だ。
* Wrapタブ：テキストをフレームに対してどのように配置するか、テキストをフレームにどの程度近づけるかを設定する。フレームの内容を周りの段落から目立たせたい場合は、折り返しを「折り返しオフ」に設定する。これはおそらく、フレームにとって最も重要なタブだ。
* 領域タブ：背景色、ビットマップ、ハッチング、グラデーション、パターンを設定する。このタブは、主に複雑なページレイアウトのテキストフレームで、テキストフレームがページの一般的な背景とは異なる外観を持つ場合に便利だ。
* 透明度タブ：選択した背景の透明度オプションを設定する。値の範囲は0%（完全に不透明）から+100%（完全に透明）だ。
* 枠線タブ：枠線の属性を設定する。
* 列タブ：このタブは、フレームをテキストに使用しない限り、無視することができる。オプションは、第6章「ページの書式設定」で説明するページスタイルの設定に使用するものと同じです：高度な設定
* マクロタブ: ユーザーがフレームを操作したときにアクションをトリガーするために、フレームで使用するマクロを設定する。これらのオプションはオンラインライターやHTML文書に便利だ。

Working with page styles
======================================================================

ページスタイルはページのプロパティ（マージン、ページサイズ、ヘッダー、フッターなど）を制御する。 しかし、段落や文字、フレームとは異なり、ページは直接プロパティを適用することはできない。ページのプロパティを変更する場合、実際には基礎となるページ・スタイルを変更することになるので、その変更はそのページ・スタイルを使用するすべてのページに適用される。個々のページのプロパティを変更するには、新しいページ・スタイルを作成する必要がある。

Creating a new page style
----------------------------------------------------------------------

新しいページスタイルを作成するには、スタイルデッキを開き、ページスタイル図像をクリックする。ウィンドウの任意の場所を右クリックし、新規作成を選択する。ページスタイルダイアログ欄には9つのタブがある。

Organizer tab
----------------------------------------------------------------------

オーガナイザー」タブについては236ページを参照。

General settings for the page style
----------------------------------------------------------------------

ページスタイルダイアログ欄のページタブでは、ページの一般的な設定をコントロールすることができる。 タブには三つのセクションと、右上のプレビューエリアがある。

用紙フォーマット]セクションでは、用紙のサイズを指定できる。あらかじめ定義された多くのフォーマットの中から選択するか、[ユーザー]を選択して[幅]フィールドと[高さ]フィールドを使用して独自の用紙サイズを定義する。用紙の向きを選択する：縦または横を選択する。プリンターーに複数のトレイがある場合は、新しいページスタイルでページを印刷するトレイを指定できる。

Margins（余白）セクションで、余白のサイズをお好みの単位で指定する。レイアウト設定セクションでページレイアウトにミラーを選択した場合、余白の名前が左と右から内側と外側に変わる。

ガターマージンは、ページの左端（または内側）と左マージン（または内側マージン）の間に残す余白で、製本を可能にする。(あるいは、ガター設定をゼロのままにして、ガターマージン量を左マージンまたは内マージンの値に追加することもできる)。ガター位置の設定も参照しろ。

Layout Settingsセクションで、ドロップダウン一覧から希望のページレイアウトを選択する。定義するページ・スタイルが左右両方のページに適用されるか（既定）、ミラーリングされたページに適用されるか、左右のページのみに適用されるかを決めます。いくつかの考慮事項がある：

* このスタイルで印刷したページを本のように製本する場合は、ミラーレイアウトを選択しろ。
* ページレイアウトで一般的なのは、左右と上下の余白を非対称にすることである。(a)外側の余白（右ページの右余白）は内側の余白（右ページの左余白）より広く、(b)下側の余白は上側の余白より大きい。
* 新しい章の最初のページが常に右ページで始まるようにしたい場合は、レイアウト設定フィールドで、最初の章ページのページスタイルが右ページだけに設定されていることを確認しろ。章の残りの部分の典型的な手順は、左ページと右ページの両方に単一の「ミラーリング」ページ・スタイル（おそらく、既定・ページ・スタイル）を定義することだ。ミラー化されたページは、異なるヘッダーとフッターを持つことができる。このようにすると、すべての章が二つのページスタイルを使うことになる。
* 左ページと右ページに別々のページスタイルを定義することもできるが、それはページの外観を大きく変えたい場合です（たとえば、余白や段組が異なる場合など。）その場合、最初のページスタイルの「次のスタイル」フィールドに左ページのみを設定し、その後に右ページのみを設定する。このようにすると、すべての章が三つのページスタイルを使うことになる。仮に、次のようなページスタイル名があるとする：最初のページ、左ページ、右ページ。

ページ番号ドロップダウン一覧を使用して、このページスタイルに適用するページ番号スタイルを指定する。

ページの行間を使用」 オプシ ョ ンは、 段落 と 段落ス タ イルの 「ページの行間を有効にする」 オプシ ョ ン と 組み合わせます （240 ページ参照）。これらのオプションの使用法の詳細については、ヘルプおよび第6章「ページの書式設定」を参照しろ：こ れ ら のオプシ ョ ンの使い方について詳 し く は、 ヘルプ と 第 6 章 「ページの組版 ： 高度な設定」 を参照 し て く だ さ い。

既定では、ページの背景（色や画像など）は余白を含むページ全体を塗りつぶする。背景を余白領域ではなくテキスト領域だけで埋めたい場合は、ダイアログ欄の右下にあるBackground covers marginsオプションの選択を解除しろ。

Area and Border tabs
----------------------------------------------------------------------

エリアタブとボーダータブについては、第6章「ページの書式設定」で詳しく説明している：詳細設定」で詳しく説明している。背景（余白を含むページ全体を覆う）を適用するには「領域」タブを、ページのテキスト領域（余白の内側）の周囲に枠線を引くには「枠線」タブを使用する。テキストエリアに影を付けることもできる。

Header and Footer tabs
----------------------------------------------------------------------

各ページスタイルに異なるヘッダーやフッターを関連付けることができる。このプロパティを使うと、左ページと右ページで異なるヘッダーをつけたり、新しい章の始まりのページでヘッダーをつけないようにしたり、といったことが簡単にできる。また、文書の最初のページに使用される同じページ・スタイルに、異なるヘッダーやフッターを持たせることもできる。

ページ]タブで[ミラー]または[左右]ページレイアウトを選択した場合、一つのスタイルを左右両方のページに使用しても、左右のページで異なるヘッダーを指定できる。このオプションは、定義済みの左ページと右ページのページスタイルや、左ページまたは右ページのみに定義されたその他のページスタイルでは使用できない。

ヘッダー］タブと［フッター］タブについては、第5章「ページの書式設定」で詳しく説明している：基本」で詳しく説明している。

Columns tab
----------------------------------------------------------------------

カラムタブを使用して、ページスタイルのカラムレイアウトを作成する。設定」「幅と間隔」「区切り線」の三つのセクションがある。希望の列数を選択する。複数の列を選択すると、「幅と間隔」セクションと「区切り線」セクションがアクティブになる。あらかじめ定義された設定（等間隔の列）を使用するか、AutoWidthオプションの選択を解除してパラメータを手動で入力することができる。一ページに複数のカラムを使用する場合、カラム間の区切り線の位置とサイズを微調整することもできる。

Footnote tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

脚注タブを使用して脚注の外観を調整する。詳しくは第5章ページの書式設定：詳しくは第5章ページの書式設定：基本をご覧ください。

Working with list styles
======================================================================

一覧スタイルは段落スタイルと一緒に働きます。一覧スタイルでは、インデント、配置、一覧アイテムに使用する番号や箇条書きの文字を定義する。単純な箇条書き一覧から複雑なマルチレベル（入れ子）一覧まで、多くの一覧スタイルを定義できる。

他のスタイルと同様、一覧スタイルを使用する主な理由は一貫性と作業のスピードアップだ。書式設定]ツールバーの[順序付き一覧の切り替え]または[順序なし一覧の切り替え]図像をクリックすると、単純な一覧をすばやく作成でき、[箇条書きと番号付け]ツールバーの図像を使用すると、非常に複雑な入れ子一覧を作成できるが、作成された一覧の外観は、あなたが望むものではないかもしれない。

書式］メニューの［箇条書きと番号］を使えば、一覧の一部または全部を手作業で書式設定できるが、後で外観を変更する必要がある場合は、手作業が多くなる。

一覧・スタイルと段落スタイルがどのように連動するかについては、第12章一覧を参照しろ。

Creating a new list style
----------------------------------------------------------------------

新しい一覧・スタイルを作成するダイアログ欄には、236ページで説明した通常のオーガナイザー・タブに加え、六つのタブがある。

Unordered, Ordered, and Image tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Unordered」、「Ordered」、「Image」の各タブには、一覧項目の記号（箇条書きや数字）の定義済み書式が含まれている。これらのいずれかをスタイルに使用するには、画像をクリックする。太い枠線が選択されていることを示する。箇条書き] タブの箇条書きはフォント文字で、[画像] タブの箇条書きは画像だ。

Outline tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

アウトライン]タブを使用して、8つの定義済みネスト一覧から選択する。また、後述するように、［位置］タブと［カスタマイズ］タブを使用して一覧をカスタマイズし、一つを選択して独自のスタイルの出発点として使用することもできる。

Position tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

一覧項目のシンボルと一覧項目のテキストのインデントと間隔を微調整するには、「位置」タブ（図233）を使用する。このタブは、「カスタマイズ」タブと組み合わせて使うと特に効果的だ。

以下の設定は、個々のレベルごとに調整することも、すべてのレベルを一度に調整することもできる（すべてのレベルを同じにする）。

* Aligned at：ページの左マージンから測った番号記号の位置。
* 番号合わせ：左」を選択すると、番号の記号が「位置合わせ」の位置から直接始まるように配置される。右揃え] を選択すると、記号は [揃えた位置] の直前で終了する。中央揃え] を選択すると、記号は [揃えられた位置] を中心に配置される。このオプションは段落の配置を設定せず、番号記号のみを設定する。
* 番号の後に続く文字：番号記号の後に続く文字（さらに、「カスタマイズ」タブで選択した任意の文字（句読点など）を番号の後に表示する。タブストップ、スペース、または何もない状態から選択する。
* でタブストップ：上記でタブストップを選択した場合は、タブの位置を指定できる。
* でインデントする：左ページマージンから、最初の行に続く番号段落または箇条書き段落のすべての行の開始位置までの距離を指定する。

.. tip::

   番号合わせやその他のパラメータがどのように機能するかを十分に理解するには、10個以上の要素を持つ番号付き一覧を作成し、2桁以上の数字に十分なスペースが確保されていることを確認しろ。また、10以上の数字を右揃えにすることもできる。

Customize tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

アウトライン・レベルのスタイルを定義するには、[Customize] タブ（図 234）を使用する。このタブで使用できるオプションは、一覧で選択したマーカのタイプによって異なる。まず、左側で修正したいレベルを選択する。10個のレベルを一度に修正するには、レベルとして1～10を選択する。定義済みのアウトラインから開始した場合、いくつかのレベルはすでに設定されている。

番号］欄で選択した番号付けのスタイル（箇条書き、図形、番号付け）に応じて、以下のオプションのいくつかがタブで利用できるようになる（図ではすべてを示していない）：

* Start at: 一覧の最初の値（例えば、1ではなく4から一覧を開始する）
* Character Style: 数値や箇条書きに使用するスタイル。
* サブレベルを表示する：番号付けスタイルに含める前のレベルの数。例えば、"2" を入力し、前のレベルが "A, B, C..." のナンバリングスタイルを使用する場合、現在のレベルのナンバリングスキームは次のようになる："A.1
* 「区切り記号 - 前 : 番号の前に表示される任意のテキスト (例えば、ステップ)
* 区切り記号 - 後 : 番号の後に表示される任意のテキスト (例えば、句読点)
* 文字選択ボタン : クリックして、箇条書きの文字を選択する。
* 画像選択ボタン：利用可能な画像の一覧（ギャラリー）を開くか、一覧マーカーとして使用するファイルを選択できる。
* 幅と高さ：画像マーカーの寸法だ。
* 比率を維持するオプション：画像マーカーの幅と高さの比率を固定する。

ダイアログ欄の右側には、変更内容のプレビューが表示される。

数値]一覧で[リンクされた画像]オプションを選択した場合、画像オブジェクトは文書に埋め込まれるのではなく、リンクされる。文書を別のコンピュータで開いた場合（同じ画像ファイルが両方のコンピュータの同じ場所にある場合を除く）、または使用されている画像ファイルがコンピュータの別の場所に移動された場合、箇条書きは表示されない。

既定値に戻すには、右下の「リセット」ボタンをクリックする。最後に、アウトラインレベルに関係なく連続番号を使用したい場合は、タブ下部の「連続番号」欄を選択する。

Solving formatting problems
======================================================================

LibreOffice Writer の 2 つの新機能は、段落スタイルと文字スタイルの使用および直接書式設定に関連する書式設定の問題の検出と修正を支援する：スタイルインスペクタとスタイルスポットライトだ。これらの機能により、LibreOffice と Microsoft Office の互換性が向上する。

Using the Style Inspector
----------------------------------------------------------------------

スタイルインスペクタ（図235）はサイドバーにある。スタイル（段落および文字）のすべての属性と、カーソルのある段落または単語に存在する直接書式が表示される。これらの詳細は、文書内の書式が正しくなかったり、一貫性がないように見える原因を突き止める際に役立つ。

スタイルインスペクタを使用して、テキスト文書の書式の問題を検出する。

* 直接書式設定によって上書きされたスタイル プロパティは、段落スタイル ツリーおよび文字スタイル ツリーで灰色表示され、そのスタイル プロパティがそれ以上有効でないことを示する。
* 子段落スタイルによって再定義された段落スタイルプロパティは灰色で表示される。
* 子文字スタイルによって再定義された文字スタイル プロパティは灰色表示される。
* 文字スタイルや文字ダイレクトプロパティによって再定義された段落スタイルやダイレクトプロパティは灰色で表示される。

例えば、段落の余白がルーラーを使った直接書式設定によって変更された場合、段落スタイルの余白プロパティは灰色アウトされ、スタイルインスペクタの「段落の直接書式設定」項目に余白プロパティが表示される。

別の例：「強調」文字スタイルが黄色の背景で単語を強調表示しているときに、ユーザーが誤って白色の背景を使用して上書きした場合、黄色の属性は灰色アウトされ、スタイルインスペクタの「直接書式設定」に白色が表示される。スタイルインスペクタには、親スタイルから分岐した属性のみが表示される。

スタイル・インスペクタのいくつかの機能は、主に上級ユーザーにとって興味深いものです：

* スタイルインスペクタは、テキストスパン、段落、しおりに関連するカーソル位置に、非表示のRDF（リソース記述フレームワーク、W3C標準）メタデータを表示できる。注釈付きテキストスパンの場合、「入れ子になったテキスト中身」項目で、入れ子になった注釈付きテキスト範囲とメタデータフィールドの境界を表示できる。
* カスタムカラーのメタデータフィールドシェーディングは、文書エディタでメタデータカテゴリを視覚化するために、注釈付きテキスト範囲またはメタデータフィールドに設定できる。これらのフィールドシェーディングを無効または有効にするには、[表示] > [フィールドシェーディング] または Ctrl+F8 を使用する。

For more information, see the Release Notes for LibreOffice 7.1 and 7.2 Community:
<https://wiki.documentfoundation.org/ReleaseNotes/7.1#Style_inspector>
<https://wiki.documentfoundation.org/ReleaseNotes/7.2#RDF_metadata_in_Style_Inspector>
<https://wiki.documentfoundation.org/ReleaseNotes/7.2#Custom_color_metadata_field_shadings>

Using the Styles Spotlight
----------------------------------------------------------------------

スタイルスポットライトは、文書に存在するスタイルと手動書式を視覚的に表示する。段落と文字に対してのみ機能する。

スポットライトを有効にするには、サイドバーの［スタイル］タブに移動し、［段落スタイル］または［文字スタイル］デッキの下部にある［スポットライト］オプションを選択する。すると、スタイル名の横に色と番号の付いた欄が表示され（図236）、段落スタイルのインジケータが左余白に表示され（図237）、テキスト内の文字スタイルが番号付きのハイライトで示される。

手動で書式設定された段落は、余白のカラーインジケータにハッチングパターンで表示される。LibreOffice > 環境設定 > LibreOffice > 全般で拡張ヒント機能を有効にすると、ツールチップにスタイル名と、関連する場合は「+ 段落の直接書式設定」の文字が表示される。
